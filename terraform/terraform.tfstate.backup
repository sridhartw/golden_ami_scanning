{
  "version": 4,
  "terraform_version": "1.0.0",
  "serial": 785,
  "lineage": "09f2836e-dcd3-ce87-e530-8966829d5f85",
  "outputs": {},
  "resources": [
    {
      "module": "module.s3",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": "private",
            "arn": "arn:aws:s3:::salesforce-ami-config-bucket",
            "bucket": "salesforce-ami-config-bucket",
            "bucket_domain_name": "salesforce-ami-config-bucket.s3.amazonaws.com",
            "bucket_prefix": null,
            "bucket_regional_domain_name": "salesforce-ami-config-bucket.s3.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "salesforce-ami-config-bucket",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "policy": null,
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "versioning": [
              {
                "enabled": true,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "analyse_findings",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "6fcf7215d7a761669f87e168bb99464e0853b7c2",
            "output_base64sha256": "7iCyNOasAQkGl8SsYECxupVmbHxyw90SxVkP0yQcKNk=",
            "output_file_mode": null,
            "output_md5": "1069f24a441103158d14bfcb21df99aa",
            "output_path": "./target/lambda/analyse_findings.zip",
            "output_sha": "6fcf7215d7a761669f87e168bb99464e0853b7c2",
            "output_size": 1009,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/analyse_findings.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "append_ssm_param",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "1338eb73c44485d6db939116898e96adf9a73bdf",
            "output_base64sha256": "qxg87sf3HCZ/DP1rl00VTuir5NQjvEySGmKal2X8xek=",
            "output_file_mode": null,
            "output_md5": "34f3c20cb70966c1df8a09553aa040bc",
            "output_path": "./target/lambda/append_ssm_param.zip",
            "output_sha": "1338eb73c44485d6db939116898e96adf9a73bdf",
            "output_size": 529,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/append_ssm_param.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "assess_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "c7354e463ae07cfaf1f41f98150325553c3cc8af",
            "output_base64sha256": "p1iWz66omA4ieLqRF1mHw0JjwsHa/7DW0vF+4DHSojA=",
            "output_file_mode": null,
            "output_md5": "1dce14c39a7d04dfaba74cf13877ada9",
            "output_path": "./target/lambda/assess_assessment.zip",
            "output_sha": "c7354e463ae07cfaf1f41f98150325553c3cc8af",
            "output_size": 940,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/assess_assessment.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "decommission_ami_version",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "c1ce8b4f5a9ee5069406b6625b55131b7162e65c",
            "output_base64sha256": "XvFYeKQ/HZE7Fb4ETt48nLIi3fChHg3egOpkqWo4QrE=",
            "output_file_mode": null,
            "output_md5": "6e98356fc333687e06ba8c59e4afe0c6",
            "output_path": "./target/lambda/decommission_ami_version.zip",
            "output_sha": "c1ce8b4f5a9ee5069406b6625b55131b7162e65c",
            "output_size": 1367,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/decommission_ami_version.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "initiate_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "b90872bbb08ae2e92032e012378c686fce44e5c9",
            "output_base64sha256": "bd7MSBVHFNq78GEtfDRMK3X/AqLAhRMts9kd6DeyT8w=",
            "output_file_mode": null,
            "output_md5": "7ec0c4b4a173858065276546ae404f81",
            "output_path": "./target/lambda/initiate_assessment.zip",
            "output_sha": "b90872bbb08ae2e92032e012378c686fce44e5c9",
            "output_size": 643,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/initiate_assessment.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "publish_ami_lambda_artifact",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "02566ec995161e08311e1dc95ae8c3776257d9ff",
            "output_base64sha256": "P3MG7JXv4tJhQIETUBnKjdNFKR3B1tmDMLONmofmuyo=",
            "output_file_mode": null,
            "output_md5": "b14b724cb2910c8205f5be6aad147240",
            "output_path": "./target/lambda/publish_ami.zip",
            "output_sha": "02566ec995161e08311e1dc95ae8c3776257d9ff",
            "output_size": 1204,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/publish_ami.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "run_inspector",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "7018da272c807f6de3c481e5b673dab50bc60b00",
            "output_base64sha256": "1qe+jOGowSfywyNvggNgNF0518BJZJezpKdDqxPjuCU=",
            "output_file_mode": null,
            "output_md5": "2fd9800f10ec725bb2a95157d04afb75",
            "output_path": "./target/lambda/run_inspector.zip",
            "output_sha": "7018da272c807f6de3c481e5b673dab50bc60b00",
            "output_size": 1033,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/run_inspector.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "archive_file",
      "name": "setup_continuous_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "262748079cb053bb4e648c6ebc8f14a45bcad756",
            "output_base64sha256": "ER0G3AB8VFcqvY40VenmyBiB5oWwWcVfGn/iWjhp++w=",
            "output_file_mode": null,
            "output_md5": "1c06505ed363dbd4377e524c4d8de0f2",
            "output_path": "./target/lambda/setup_continuous_assessment.zip",
            "output_sha": "262748079cb053bb4e648c6ebc8f14a45bcad756",
            "output_size": 1227,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": "modules/scanner/source_code/setup_continuous_assessment.py",
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "246512022090",
            "arn": "arn:aws:iam::246512022090:user/sridhar",
            "id": "246512022090",
            "user_id": "AIDATSZKC6JFDLU32XPPU"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "aws_region",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "analyse_findings",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "b6ec365938a9f26982c38576e8b67e6ec07d9c0fc57a39779cd67f94ee1fa45a",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:AddAttributesToFindings\",\n        \"inspector:DescribeFindings\",\n        \"ec2:DescribeInstances\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sns:Publish\",\n      \"Resource\": [\"arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result\"]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/continuous-assessment-instance\": \"true\"\n        }\n      }\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:AddAttributesToFindings\",\n        \"inspector:DescribeFindings\",\n        \"ec2:DescribeInstances\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sns:Publish\",\n      \"Resource\": [\"${continuous_result_topic}\"]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/continuous-assessment-instance\": \"true\"\n        }\n      }\n    }\n  ]\n}",
            "vars": {
              "continuous_result_topic": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "append_ssm_param",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "d05d4d83e6ef5ac99443afbcb46a4b4d6fd4c1d3ce7161ffedd551c5a13f6c19",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    }\n  ]\n}\n\n",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    }\n  ]\n}\n\n",
            "vars": {
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "approver_topic",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "fb914574984ec3145eb7feb6a85cd92f2f631c9c88d8b827608f24b76253dc52",
            "rendered": "{\n  \"Id\": \"ApproverTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ApproverTopicPolicySID\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\"\n        ]\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Id\": \"ApproverTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ApproverTopicPolicySID\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": [\n          \"${automation_service_role}\"\n        ]\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": {
              "automation_service_role": "arn:aws:iam::246512022090:role/terraform-20210907105437499900000002"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "assess_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "bb9fd1f71855f035bf7e740500024e5b450622c10f2981b5f233b3de2e3fa21b",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:DescribeAssessmentTemplates\",\n        \"inspector:DescribeFindings\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:DescribeAssessmentTemplates\",\n        \"inspector:DescribeFindings\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": {
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "assessment_complete",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "4f76705690fb44c0e4deae7a8df2cd0f42e7900887de52b51cc608a1e68eac37",
            "rendered": "{\n  \"Id\": \"MyTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"My-statement-id\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"inspector.amazonaws.com\"\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Id\": \"MyTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"My-statement-id\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"inspector.amazonaws.com\"\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "automation_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "12a4c0accb18f75f6f7a70dd73f1476be399983d7dd798c253515acdd312a6c5",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:InvokeFunction\",\n      \"Resource\": [\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment\"\n      ]\n    }\n  ]\n}\n",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"${managed_instance_iam_role}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:InvokeFunction\",\n      \"Resource\": [\n        \"${run_inspector_arn}\",\n        \"${append_ssm_param_arn}\",\n        \"${publish_ami_arn}\",\n        \"${run_inspector_arn}\",\n        \"${decommision_ami_version_arn}\",\n        \"${initiate_assessment_arn}\"\n      ]\n    }\n  ]\n}\n",
            "vars": {
              "append_ssm_param_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param",
              "decommision_ami_version_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version",
              "initiate_assessment_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment",
              "managed_instance_iam_role": "arn:aws:iam::246512022090:role/terraform-20210907105437466900000001",
              "publish_ami_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda",
              "run_inspector_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "decommision_ami_version_doc",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "986f51b45bbc6e30377f5f38b41780975d6dbed682466173822b264d9b8e47d8",
            "rendered": "{\n  \"description\": \"This automation document triggers golden AMI build decommissioning workflow\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"bucketName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains name of the bucket in which CFT template file is stored\",\n      \"default\": \"arn:aws:s3:::salesforce-ami-config-bucket\"\n    },\n    \"templateFileName\": {\n      \"type\": \"String\",\n      \"description\": \"The CFT template file-name used for creating the Service Catalog product\",\n      \"default\": \"simpleEC2-SSMParamInput.json\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion\",\n      \"default\": \"salesforce\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n      \"default\": \"Windows_Server-20H2-English-Core-Base-2021.05.12\"\n    },\n    \"buildVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI build number to be decommissioned.\",\n      \"default\": \"1.0\"\n    },\n    \"MetadataParamName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter points to an SSM parameter used for storing some process specific metadata. Do not change the default value.\",\n      \"default\": \"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{buildVersion}}/temp\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"DecommissionAMIVersionLambda\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version\",\n        \"Payload\": \"{\\\"bucketName\\\":\\\"{{ bucketName }}\\\", \\\"amiRegionMappingParamName\\\":\\\"{{ MetadataParamName }}\\\", \\\"templateFileName\\\":\\\"{{templateFileName}}\\\", \\\"versionToBeDeleted\\\":\\\"{{ buildVersion }}\\\", \\\"productOSAndVersion\\\":\\\"{{ productOSAndVersion }}\\\", \\\"productNameAndVersion\\\":\\\"{{ productName }}\\\"}\"\n      }\n    }\n  ]\n}",
            "template": "{\n  \"description\": \"This automation document triggers golden AMI build decommissioning workflow\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"${automation_service_role}\",\n  \"parameters\": {\n    \"bucketName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains name of the bucket in which CFT template file is stored\",\n      \"default\": \"${ami_config_bucket}\"\n    },\n    \"templateFileName\": {\n      \"type\": \"String\",\n      \"description\": \"The CFT template file-name used for creating the Service Catalog product\",\n      \"default\": \"simpleEC2-SSMParamInput.json\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion\",\n      \"default\": \"${resource-prefix}\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n      \"default\": \"${default_ami}\"\n    },\n    \"buildVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI build number to be decommissioned.\",\n      \"default\": \"1.0\"\n    },\n    \"MetadataParamName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter points to an SSM parameter used for storing some process specific metadata. Do not change the default value.\",\n      \"default\": \"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{buildVersion}}/temp\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"DecommissionAMIVersionLambda\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"${decommision_ami_version_lambda}\",\n        \"Payload\": \"{\\\"bucketName\\\":\\\"{{ bucketName }}\\\", \\\"amiRegionMappingParamName\\\":\\\"{{ MetadataParamName }}\\\", \\\"templateFileName\\\":\\\"{{templateFileName}}\\\", \\\"versionToBeDeleted\\\":\\\"{{ buildVersion }}\\\", \\\"productOSAndVersion\\\":\\\"{{ productOSAndVersion }}\\\", \\\"productNameAndVersion\\\":\\\"{{ productName }}\\\"}\"\n      }\n    }\n  ]\n}",
            "vars": {
              "ami_config_bucket": "arn:aws:s3:::salesforce-ami-config-bucket",
              "automation_service_role": "arn:aws:iam::246512022090:role/terraform-20210907105437499900000002",
              "decommision_ami_version_lambda": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version",
              "default_ami": "Windows_Server-20H2-English-Core-Base-2021.05.12",
              "resource-prefix": "salesforce"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "decommission_ami_version",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "27324a2f94bf96b22386974b024f6013661a322936ad590f65968d3ecdc0139d",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\",\n        \"ssm:delete*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:delete*\",\n        \"s3:get*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::salesforce-ami-config-bucket/*\",\n        \"arn:aws:s3:::salesforce-ami-config-bucket\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DeleteSnapshot\",\n        \"sc:list*\",\n        \"sc:search*\",\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:ListProvisioningArtifacts\",\n        \"servicecatalog:DeleteProduct\",\n        \"servicecatalog:DeleteProvisioningArtifact\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\",\n        \"ssm:delete*\"\n      ],\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:delete*\",\n        \"s3:get*\"\n      ],\n      \"Resource\": [\n        \"${ami_config_bucket}/*\",\n        \"${ami_config_bucket}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DeleteSnapshot\",\n        \"sc:list*\",\n        \"sc:search*\",\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:ListProvisioningArtifacts\",\n        \"servicecatalog:DeleteProduct\",\n        \"servicecatalog:DeleteProvisioningArtifact\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": {
              "ami_config_bucket": "arn:aws:s3:::salesforce-ami-config-bucket",
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "golden_ami_automation",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "55e2428a2d87d41ae5898fad3af91a57587c50a7baa90fb2e347542390d30874",
            "rendered": "{\n  \"description\": \"This automation document triggers Golden AMI creation workflow.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"sourceAMIid\": {\n      \"type\": \"String\",\n      \"description\": \"Source/Base AMI to be used for generating your golden AMI\",\n      \"default\": \"{{ssm:/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2}}\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion.\",\n      \"default\": \"salesforce\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n       \"default\": \"Windows_Server-20H2-English-Core-Base-2021.05.12\"\n    },\n    \"ApproverARN\": {\n      \"type\": \"String\",\n      \"description\": \"AWS authenticated principals who are able to either approve or reject the Golden AMI. You can specify principals by using an AWS Identity and Access Management (IAM) user name, IAM user ARN, IAM role ARN, or an IAM assume role user ARN.\",\n      \"default\": \"abc\"\n    },\n    \"ApproverNotificationArn\": {\n      \"type\": \"String\",\n      \"description\": \"SNS Topic ARN on which a notification would be published once the golden AMI candidate is ready for validation.\",\n      \"default\": \"arn:aws:sns:us-east-1:246512022090:salesforce-approver\"\n    },\n    \"AMIVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI Build version number to be created.\",\n      \"default\": \"1.0\"\n    },\n    \"subnetId\": {\n      \"type\": \"String\",\n      \"default\": \"arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f\",\n      \"description\": \"Subnet in which instances will be launched.\"\n    },\n    \"securityGroupId\": {\n      \"type\": \"String\",\n      \"default\": \"sg-0eb183a7c40d99209\",\n      \"description\": \"Security Group that will be attached to the instance. By Default a security group without any inbound access is attached\"\n    },\n    \"instanceType\": {\n      \"type\": \"String\",\n      \"description\": \"A compatible instance-type for launching an instance\",\n      \"default\": \"t3.large\"\n    },\n    \"targetAMIname\": {\n      \"type\": \"String\",\n      \"description\": \"Name for the golden AMI to be created\",\n      \"default\": \"{{productName}}-{{productOSAndVersion}}-{{AMIVersion}}\"\n    },\n    \"ManagedInstanceProfile\": {\n      \"type\": \"String\",\n      \"description\": \"Instance Profile. Do not change the default value.\",\n      \"default\": \"arn:aws:iam::246512022090:instance-profile/managed_instance_profile\"\n    },\n    \"SSMInstallationUserData\": {\n      \"type\": \"String\",\n      \"description\": \"Base64 encoded SSM installation user-data.\",\n      \"default\": \"IyEvYmluL2Jhc2gNCg0KZnVuY3Rpb24gZ2V0X2NvbnRlbnRzKCkgew0KICAgIGlmIFsgLXggIiQod2hpY2ggY3VybCkiIF07IHRoZW4NCiAgICAgICAgY3VybCAtcyAtZiAiJDEiDQogICAgZWxpZiBbIC14ICIkKHdoaWNoIHdnZXQpIiBdOyB0aGVuDQogICAgICAgIHdnZXQgIiQxIiAtTyAtDQogICAgZWxzZQ0KICAgICAgICBkaWUgIk5vIGRvd25sb2FkIHV0aWxpdHkgKGN1cmwsIHdnZXQpIg0KICAgIGZpDQp9DQoNCnJlYWRvbmx5IElERU5USVRZX1VSTD0iaHR0cDovLzE2OS4yNTQuMTY5LjI1NC8yMDE2LTA2LTMwL2R5bmFtaWMvaW5zdGFuY2UtaWRlbnRpdHkvZG9jdW1lbnQvIg0KcmVhZG9ubHkgVFJVRV9SRUdJT049JChnZXRfY29udGVudHMgIiRJREVOVElUWV9VUkwiIHwgYXdrIC1GXCIgJy9yZWdpb24vIHsgcHJpbnQgJDQgfScpDQpyZWFkb25seSBERUZBVUxUX1JFR0lPTj0idXMtZWFzdC0xIg0KcmVhZG9ubHkgUkVHSU9OPSIke1RSVUVfUkVHSU9OOi0kREVGQVVMVF9SRUdJT059Ig0KDQpyZWFkb25seSBTQ1JJUFRfTkFNRT0iYXdzLWluc3RhbGwtc3NtLWFnZW50Ig0KIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5hbWF6b25hd3MuY29tL3NjcmlwdHMvJFNDUklQVF9OQU1FIg0KDQppZiBbICIkUkVHSU9OIiA9ICJjbi1ub3J0aC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5jbi1ub3J0aC0xLmFtYXpvbmF3cy5jb20uY24vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQppZiBbICIkUkVHSU9OIiA9ICJ1cy1nb3Ytd2VzdC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy11cy1nb3Ytd2VzdC0xLmFtYXpvbmF3cy5jb20vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQpjZCAvdG1wDQpGSUxFX1NJWkU9MA0KTUFYX1JFVFJZX0NPVU5UPTMNClJFVFJZX0NPVU5UPTANCg0Kd2hpbGUgWyAkUkVUUllfQ09VTlQgLWx0ICRNQVhfUkVUUllfQ09VTlQgXSA7IGRvDQogIGVjaG8gQVdTLVVwZGF0ZUxpbnV4QW1pOiBEb3dubG9hZGluZyBzY3JpcHQgZnJvbSAkU0NSSVBUX1VSTA0KICBnZXRfY29udGVudHMgIiRTQ1JJUFRfVVJMIiA+ICIkU0NSSVBUX05BTUUiDQogIEZJTEVfU0laRT0kKGR1IC1rIC90bXAvJFNDUklQVF9OQU1FIHwgY3V0IC1mMSkNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbmlzaGVkIGRvd25sb2FkaW5nIHNjcmlwdCwgc2l6ZTogJEZJTEVfU0laRQ0KICBpZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICAgIGJyZWFrDQogIGVsc2UNCiAgICBpZiBbWyAkUkVUUllfQ09VTlQgLWx0IE1BWF9SRVRSWV9DT1VOVCBdXTsgdGhlbg0KICAgICAgUkVUUllfQ09VTlQ9JCgoUkVUUllfQ09VTlQrMSkpOw0KICAgICAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbGVTaXplIGlzIDAsIHJldHJ5Q291bnQ6ICRSRVRSWV9DT1VOVA0KICAgIGZpDQogIGZpIA0KZG9uZQ0KDQppZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICBjaG1vZCAreCAiJFNDUklQVF9OQU1FIg0KICBlY2hvIEFXUy1VcGRhdGVMaW51eEFtaTogUnVubmluZyBVcGRhdGVTU01BZ2VudCBzY3JpcHQgbm93IC4uLi4NCiAgLi8iJFNDUklQVF9OQU1FIiAtLXJlZ2lvbiAiJFJFR0lPTiINCmVsc2UNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IFVuYWJsZSB0byBkb3dubG9hZCBzY3JpcHQsIHF1aXR0aW5nIC4uLi4NCmZp\"\n    },\n    \"PreUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run before updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"PostUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run after package updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"IncludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Only update these named packages. By default (\\\"all\\\"), all available updates are applied.\",\n      \"default\": \"all\"\n    },\n    \"ExcludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Names of packages to hold back from updates, under all conditions. By default (\\\"none\\\"), no package is excluded.\",\n      \"default\": \"none\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"startInstances\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 3600,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ sourceAMIid }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"UserData\": \"{{SSMInstallationUserData}}\",\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"updateSSMAgent\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-UpdateSSMAgent\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"describeInstance\",\n      \"action\": \"aws:executeAwsApi\",\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"Service\": \"ec2\",\n        \"Api\": \"DescribeInstances\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"outputs\": [\n        {\n          \"Name\": \"Platform\",\n          \"Selector\": \"$.Reservations[0].Instances[0].Platform\",\n          \"Type\": \"String\"\n        }\n      ],\n      \"nextStep\": \"branchOnInstancePlatform\"\n    },\n    {\n      \"name\": \"branchOnInstancePlatform\",\n      \"action\": \"aws:branch\",\n      \"inputs\": {\n        \"Choices\": [\n          {\n            \"NextStep\": \"installWindowsUpdates\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"windows\"\n          },\n          {\n            \"NextStep\": \"updateOSSoftware\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"linux\"\n          }\n        ],\n        \"Default\": \"updateOSSoftware\"\n      }\n    },\n    {\n      \"name\": \"installWindowsUpdates\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-InstallWindowsUpdates\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"updateOSSoftware\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AWS-RunShellScript\",\n        \"InstanceIds\": [\n          \"{{startInstances.InstanceIds}}\"\n        ],\n        \"Parameters\": {\n          \"commands\": [\n            \"set -e\",\n            \"[ -x \\\"$(which wget)\\\" ] \u0026\u0026 get_contents='wget $1 -O -'\",\n            \"[ -x \\\"$(which curl)\\\" ] \u0026\u0026 get_contents='curl -s -f $1'\",\n            \"eval $get_contents https://aws-ssm-downloads-{{global:REGION}}.s3.amazonaws.com/scripts/aws-update-linux-instance \u003e /tmp/aws-update-linux-instance\",\n            \"chmod +x /tmp/aws-update-linux-instance\",\n            \"/tmp/aws-update-linux-instance --pre-update-script '{{PreUpdateScript}}' --post-update-script '{{PostUpdateScript}}' --include-packages '{{IncludePackages}}' --exclude-packages '{{ExcludePackages}}' 2\u003e\u00261 | tee /tmp/aws-update-linux-instance.log\"\n          ]\n        }\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"stopInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"stopped\"\n      }\n    },\n    {\n      \"name\": \"createImage\",\n      \"action\": \"aws:createImage\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceId\": \"{{ startInstances.InstanceIds }}\",\n        \"ImageName\": \"{{ targetAMIname }}\",\n        \"NoReboot\": true,\n        \"ImageDescription\": \"AMI created by EC2 Automation\"\n      }\n    },\n    {\n      \"name\": \"TagTheAMI\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createImage.ImageId }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"ProductOSAndVersion\",\n            \"Value\": \"{{productOSAndVersion}}\"\n          },\n          {\n            \"Key\": \"ProductName\",\n            \"Value\": \"{{productName}}\"\n          },\n          {\n            \"Key\": \"version\",\n            \"Value\": \"{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"AMI-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"terminateFirstInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"createInstanceFromNewImage\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ createImage.ImageId }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"InstallInspector\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AmazonInspector-ManageAWSAgent\",\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Parameters\": {\n          \"Operation\": \"Install\"\n        }\n      }\n    },\n    {\n      \"name\": \"TagNewinstance\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"Type\",\n            \"Value\": \"{{createImage.ImageId}}-{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"Automation-Instance-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"InspectBaseInstance\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 120,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"Payload\": \"{\\\"AMI-ID\\\": \\\"{{createImage.ImageId}}\\\",\\\"topicArn\\\":\\\"arn:aws:sns:us-east-1:246512022090:salesforce-approver\\\",\\\"instanceId\\\": \\\"{{ createInstanceFromNewImage.InstanceIds }}\\\",\\\"productOS\\\": \\\"{{productOSAndVersion}}\\\",\\\"productName\\\": \\\"{{productName}}\\\",\\\"productVersion\\\": \\\"{{AMIVersion}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT2M\"\n      }\n    },\n    {\n      \"name\": \"terminateInspectorInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"addNewVersionParameter\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"approve\",\n      \"action\": \"aws:approve\",\n      \"timeoutSeconds\": 172800,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"NotificationArn\": \"{{ ApproverNotificationArn }}\",\n        \"Message\": \"Please check contents of SSM Parameter : /GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}/NumCVEs and approve/deny the build.\",\n        \"MinRequiredApprovals\": 1,\n        \"Approvers\": [\n          \"{{ ApproverARN }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"updateLatestVersionValue\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\":  \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/latest\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    }\n  ],\n  \"outputs\": [\n    \"createImage.ImageId\"\n  ]\n}",
            "template": "{\n  \"description\": \"This automation document triggers Golden AMI creation workflow.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"${automation_service_role}\",\n  \"parameters\": {\n    \"sourceAMIid\": {\n      \"type\": \"String\",\n      \"description\": \"Source/Base AMI to be used for generating your golden AMI\",\n      \"default\": \"{{ssm:/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2}}\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion.\",\n      \"default\": \"${resource-prefix}\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n       \"default\": \"${default_ami}\"\n    },\n    \"ApproverARN\": {\n      \"type\": \"String\",\n      \"description\": \"AWS authenticated principals who are able to either approve or reject the Golden AMI. You can specify principals by using an AWS Identity and Access Management (IAM) user name, IAM user ARN, IAM role ARN, or an IAM assume role user ARN.\",\n      \"default\": \"${approver_arn}\"\n    },\n    \"ApproverNotificationArn\": {\n      \"type\": \"String\",\n      \"description\": \"SNS Topic ARN on which a notification would be published once the golden AMI candidate is ready for validation.\",\n      \"default\": \"${approver_topic_arn}\"\n    },\n    \"AMIVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI Build version number to be created.\",\n      \"default\": \"1.0\"\n    },\n    \"subnetId\": {\n      \"type\": \"String\",\n      \"default\": \"${subnet_id}\",\n      \"description\": \"Subnet in which instances will be launched.\"\n    },\n    \"securityGroupId\": {\n      \"type\": \"String\",\n      \"default\": \"${security_group}\",\n      \"description\": \"Security Group that will be attached to the instance. By Default a security group without any inbound access is attached\"\n    },\n    \"instanceType\": {\n      \"type\": \"String\",\n      \"description\": \"A compatible instance-type for launching an instance\",\n      \"default\": \"${instance_type}\"\n    },\n    \"targetAMIname\": {\n      \"type\": \"String\",\n      \"description\": \"Name for the golden AMI to be created\",\n      \"default\": \"{{productName}}-{{productOSAndVersion}}-{{AMIVersion}}\"\n    },\n    \"ManagedInstanceProfile\": {\n      \"type\": \"String\",\n      \"description\": \"Instance Profile. Do not change the default value.\",\n      \"default\": \"${managed_instance_profile}\"\n    },\n    \"SSMInstallationUserData\": {\n      \"type\": \"String\",\n      \"description\": \"Base64 encoded SSM installation user-data.\",\n      \"default\": \"IyEvYmluL2Jhc2gNCg0KZnVuY3Rpb24gZ2V0X2NvbnRlbnRzKCkgew0KICAgIGlmIFsgLXggIiQod2hpY2ggY3VybCkiIF07IHRoZW4NCiAgICAgICAgY3VybCAtcyAtZiAiJDEiDQogICAgZWxpZiBbIC14ICIkKHdoaWNoIHdnZXQpIiBdOyB0aGVuDQogICAgICAgIHdnZXQgIiQxIiAtTyAtDQogICAgZWxzZQ0KICAgICAgICBkaWUgIk5vIGRvd25sb2FkIHV0aWxpdHkgKGN1cmwsIHdnZXQpIg0KICAgIGZpDQp9DQoNCnJlYWRvbmx5IElERU5USVRZX1VSTD0iaHR0cDovLzE2OS4yNTQuMTY5LjI1NC8yMDE2LTA2LTMwL2R5bmFtaWMvaW5zdGFuY2UtaWRlbnRpdHkvZG9jdW1lbnQvIg0KcmVhZG9ubHkgVFJVRV9SRUdJT049JChnZXRfY29udGVudHMgIiRJREVOVElUWV9VUkwiIHwgYXdrIC1GXCIgJy9yZWdpb24vIHsgcHJpbnQgJDQgfScpDQpyZWFkb25seSBERUZBVUxUX1JFR0lPTj0idXMtZWFzdC0xIg0KcmVhZG9ubHkgUkVHSU9OPSIke1RSVUVfUkVHSU9OOi0kREVGQVVMVF9SRUdJT059Ig0KDQpyZWFkb25seSBTQ1JJUFRfTkFNRT0iYXdzLWluc3RhbGwtc3NtLWFnZW50Ig0KIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5hbWF6b25hd3MuY29tL3NjcmlwdHMvJFNDUklQVF9OQU1FIg0KDQppZiBbICIkUkVHSU9OIiA9ICJjbi1ub3J0aC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5jbi1ub3J0aC0xLmFtYXpvbmF3cy5jb20uY24vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQppZiBbICIkUkVHSU9OIiA9ICJ1cy1nb3Ytd2VzdC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy11cy1nb3Ytd2VzdC0xLmFtYXpvbmF3cy5jb20vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQpjZCAvdG1wDQpGSUxFX1NJWkU9MA0KTUFYX1JFVFJZX0NPVU5UPTMNClJFVFJZX0NPVU5UPTANCg0Kd2hpbGUgWyAkUkVUUllfQ09VTlQgLWx0ICRNQVhfUkVUUllfQ09VTlQgXSA7IGRvDQogIGVjaG8gQVdTLVVwZGF0ZUxpbnV4QW1pOiBEb3dubG9hZGluZyBzY3JpcHQgZnJvbSAkU0NSSVBUX1VSTA0KICBnZXRfY29udGVudHMgIiRTQ1JJUFRfVVJMIiA+ICIkU0NSSVBUX05BTUUiDQogIEZJTEVfU0laRT0kKGR1IC1rIC90bXAvJFNDUklQVF9OQU1FIHwgY3V0IC1mMSkNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbmlzaGVkIGRvd25sb2FkaW5nIHNjcmlwdCwgc2l6ZTogJEZJTEVfU0laRQ0KICBpZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICAgIGJyZWFrDQogIGVsc2UNCiAgICBpZiBbWyAkUkVUUllfQ09VTlQgLWx0IE1BWF9SRVRSWV9DT1VOVCBdXTsgdGhlbg0KICAgICAgUkVUUllfQ09VTlQ9JCgoUkVUUllfQ09VTlQrMSkpOw0KICAgICAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbGVTaXplIGlzIDAsIHJldHJ5Q291bnQ6ICRSRVRSWV9DT1VOVA0KICAgIGZpDQogIGZpIA0KZG9uZQ0KDQppZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICBjaG1vZCAreCAiJFNDUklQVF9OQU1FIg0KICBlY2hvIEFXUy1VcGRhdGVMaW51eEFtaTogUnVubmluZyBVcGRhdGVTU01BZ2VudCBzY3JpcHQgbm93IC4uLi4NCiAgLi8iJFNDUklQVF9OQU1FIiAtLXJlZ2lvbiAiJFJFR0lPTiINCmVsc2UNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IFVuYWJsZSB0byBkb3dubG9hZCBzY3JpcHQsIHF1aXR0aW5nIC4uLi4NCmZp\"\n    },\n    \"PreUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run before updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"PostUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run after package updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"IncludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Only update these named packages. By default (\\\"all\\\"), all available updates are applied.\",\n      \"default\": \"all\"\n    },\n    \"ExcludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Names of packages to hold back from updates, under all conditions. By default (\\\"none\\\"), no package is excluded.\",\n      \"default\": \"none\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"startInstances\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 3600,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ sourceAMIid }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"UserData\": \"{{SSMInstallationUserData}}\",\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"updateSSMAgent\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-UpdateSSMAgent\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"describeInstance\",\n      \"action\": \"aws:executeAwsApi\",\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"Service\": \"ec2\",\n        \"Api\": \"DescribeInstances\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"outputs\": [\n        {\n          \"Name\": \"Platform\",\n          \"Selector\": \"$.Reservations[0].Instances[0].Platform\",\n          \"Type\": \"String\"\n        }\n      ],\n      \"nextStep\": \"branchOnInstancePlatform\"\n    },\n    {\n      \"name\": \"branchOnInstancePlatform\",\n      \"action\": \"aws:branch\",\n      \"inputs\": {\n        \"Choices\": [\n          {\n            \"NextStep\": \"installWindowsUpdates\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"windows\"\n          },\n          {\n            \"NextStep\": \"updateOSSoftware\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"linux\"\n          }\n        ],\n        \"Default\": \"updateOSSoftware\"\n      }\n    },\n    {\n      \"name\": \"installWindowsUpdates\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-InstallWindowsUpdates\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"updateOSSoftware\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AWS-RunShellScript\",\n        \"InstanceIds\": [\n          \"{{startInstances.InstanceIds}}\"\n        ],\n        \"Parameters\": {\n          \"commands\": [\n            \"set -e\",\n            \"[ -x \\\"$(which wget)\\\" ] \u0026\u0026 get_contents='wget $1 -O -'\",\n            \"[ -x \\\"$(which curl)\\\" ] \u0026\u0026 get_contents='curl -s -f $1'\",\n            \"eval $get_contents https://aws-ssm-downloads-{{global:REGION}}.s3.amazonaws.com/scripts/aws-update-linux-instance \u003e /tmp/aws-update-linux-instance\",\n            \"chmod +x /tmp/aws-update-linux-instance\",\n            \"/tmp/aws-update-linux-instance --pre-update-script '{{PreUpdateScript}}' --post-update-script '{{PostUpdateScript}}' --include-packages '{{IncludePackages}}' --exclude-packages '{{ExcludePackages}}' 2\u003e\u00261 | tee /tmp/aws-update-linux-instance.log\"\n          ]\n        }\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"stopInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"stopped\"\n      }\n    },\n    {\n      \"name\": \"createImage\",\n      \"action\": \"aws:createImage\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceId\": \"{{ startInstances.InstanceIds }}\",\n        \"ImageName\": \"{{ targetAMIname }}\",\n        \"NoReboot\": true,\n        \"ImageDescription\": \"AMI created by EC2 Automation\"\n      }\n    },\n    {\n      \"name\": \"TagTheAMI\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createImage.ImageId }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"ProductOSAndVersion\",\n            \"Value\": \"{{productOSAndVersion}}\"\n          },\n          {\n            \"Key\": \"ProductName\",\n            \"Value\": \"{{productName}}\"\n          },\n          {\n            \"Key\": \"version\",\n            \"Value\": \"{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"AMI-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"terminateFirstInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"createInstanceFromNewImage\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ createImage.ImageId }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"InstallInspector\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AmazonInspector-ManageAWSAgent\",\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Parameters\": {\n          \"Operation\": \"Install\"\n        }\n      }\n    },\n    {\n      \"name\": \"TagNewinstance\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"Type\",\n            \"Value\": \"{{createImage.ImageId}}-{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"Automation-Instance-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"InspectBaseInstance\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 120,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"${run_inspector_arn}\",\n        \"Payload\": \"{\\\"AMI-ID\\\": \\\"{{createImage.ImageId}}\\\",\\\"topicArn\\\":\\\"${inspector_complete_topic}\\\",\\\"instanceId\\\": \\\"{{ createInstanceFromNewImage.InstanceIds }}\\\",\\\"productOS\\\": \\\"{{productOSAndVersion}}\\\",\\\"productName\\\": \\\"{{productName}}\\\",\\\"productVersion\\\": \\\"{{AMIVersion}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT2M\"\n      }\n    },\n    {\n      \"name\": \"terminateInspectorInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"addNewVersionParameter\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"${append_ssm_param_arn}\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"approve\",\n      \"action\": \"aws:approve\",\n      \"timeoutSeconds\": 172800,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"NotificationArn\": \"{{ ApproverNotificationArn }}\",\n        \"Message\": \"Please check contents of SSM Parameter : /GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}/NumCVEs and approve/deny the build.\",\n        \"MinRequiredApprovals\": 1,\n        \"Approvers\": [\n          \"{{ ApproverARN }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"updateLatestVersionValue\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\":  \"${append_ssm_param_arn}\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/latest\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    }\n  ],\n  \"outputs\": [\n    \"createImage.ImageId\"\n  ]\n}",
            "vars": {
              "append_ssm_param_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param",
              "approver_arn": "abc",
              "approver_topic_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
              "automation_service_role": "arn:aws:iam::246512022090:role/terraform-20210907105437499900000002",
              "default_ami": "Windows_Server-20H2-English-Core-Base-2021.05.12",
              "inspector_complete_topic": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
              "instance_type": "t3.large",
              "managed_instance_profile": "arn:aws:iam::246512022090:instance-profile/managed_instance_profile",
              "resource-prefix": "salesforce",
              "run_inspector_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector",
              "security_group": "sg-0eb183a7c40d99209",
              "subnet_id": "arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "initiate_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "7f35b9da53b2e9ed3ae94534b050a53c89b6670d9d7c8675bbe2e7acd29ae6f5",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Action\": \"ssm:SendCommand\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:ssm:us-east-1::document/AmazonInspector-ManageAWSAgent\",\n        \"arn:aws:ec2:us-east-1:246512022090:instance/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:ListAssessmentTemplates\",\n        \"inspector:StartAssessmentRun\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    },\n    {\n      \"Action\": \"ssm:SendCommand\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:ssm:${region}::document/AmazonInspector-ManageAWSAgent\",\n        \"arn:aws:ec2:${region}:${account}:instance/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:ListAssessmentTemplates\",\n        \"inspector:StartAssessmentRun\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": {
              "account": "246512022090",
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*",
              "region": "us-east-1"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "inspector_complete",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "eb169b24c93574a5b1061ea15c445d3ad4536753d9244350fec9eb02179dd06f",
            "rendered": "{\n  \"Id\": \"MyTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"inspector-notifications-policy\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::485811472374:root\"\n\n        ]\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "template": "{\n  \"Id\": \"MyTopicPolicy\",\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"inspector-notifications-policy\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::485811472374:root\"\n\n        ]\n      },\n      \"Action\": \"sns:Publish\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "vars": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "managed_instance",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "5f5e4d6d6493f8638a6fa11f6a1022268f1ba511cfaf3db2ac7114be75225527",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Action\": [\n      \"s3:*\"\n    ],\n    \"Effect\": \"Allow\",\n    \"Resource\": [\n      \"arn:aws:s3:::salesforce-ami-config-bucket/*\",\n      \"arn:aws:s3:::salesforce-ami-config-bucket\"\n    ]\n  }\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Action\": [\n      \"s3:*\"\n    ],\n    \"Effect\": \"Allow\",\n    \"Resource\": [\n      \"${ami_config_bucket}/*\",\n      \"${ami_config_bucket}\"\n    ]\n  }\n}",
            "vars": {
              "ami_config_bucket": "arn:aws:s3:::salesforce-ami-config-bucket"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "publish_ami_policy_json",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "e5f5e36fe91383a09f26fd37ccc358f51d3de334baf0400a2dacfb9606e102d7",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject*\",\n        \"s3:PutObject*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::salesforce-ami-config-bucket/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:CreateProvisioningArtifact\",\n        \"servicecatalog:CreateProduct\",\n        \"cloudformation:ValidateTemplate\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\"\n      ],\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject*\",\n        \"s3:PutObject*\"\n      ],\n      \"Resource\": [\n        \"${ami_config_bucket}/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:CreateProvisioningArtifact\",\n        \"servicecatalog:CreateProduct\",\n        \"cloudformation:ValidateTemplate\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
            "vars": {
              "ami_config_bucket": "arn:aws:s3:::salesforce-ami-config-bucket",
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "run_continuous_inspection",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "da9b746ef63b35f40f7d8f51e35fb550c6e16fc772f87ab30095e6db7ed705eb",
            "rendered": "{\n  \"description\": \"This automation document is triggered as part of the continuous vulnerability assessment on all active golden AMIs.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"instanceIDs\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains list of instance-ids on which continuous vulnerability assessment is  performed.\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT6M\"\n      }\n    },\n    {\n      \"name\": \"InitiateAssessmentLambdaFunction\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment\",\n        \"Payload\": \"{\\\"instanceIDs\\\":\\\"{{ instanceIDs }}\\\"}\"\n      }\n    }\n  ]\n}",
            "template": "{\n  \"description\": \"This automation document is triggered as part of the continuous vulnerability assessment on all active golden AMIs.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"${automation_service_role}\",\n  \"parameters\": {\n    \"instanceIDs\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains list of instance-ids on which continuous vulnerability assessment is  performed.\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT6M\"\n      }\n    },\n    {\n      \"name\": \"InitiateAssessmentLambdaFunction\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"${initiate_assessment_lambda}\",\n        \"Payload\": \"{\\\"instanceIDs\\\":\\\"{{ instanceIDs }}\\\"}\"\n      }\n    }\n  ]\n}",
            "vars": {
              "automation_service_role": "arn:aws:iam::246512022090:role/terraform-20210907105437499900000002",
              "initiate_assessment_lambda": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "run_inspector",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ff8f7e20e00207e9752ae517bc075ee13c6433e00fa56f3cf8320f085f311fd1",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"${golden_ami_parameter}\"\n      ]\n    }\n  ]\n}",
            "vars": {
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "data",
      "type": "template_file",
      "name": "setup_continuous_assessment",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "345d20ac9f6f3099a48b88320e20cfb2c4993e1d77dde97f67595943eed77489",
            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"StartContinuousAssessmentLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:StartAutomationExecution\",\n      \"Resource\": [\n        \"arn:aws:ssm:us-east-1:246512022090:automation-definition/:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopyImage\",\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:createTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AMI-Type\",\n            \"ProductName\",\n            \"continuous-assessment-instance\",\n            \"ProductOSAndVersion\",\n            \"version\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssociateIamInstanceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:us-east-1::image/ami-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AMI-Type\": \"Golden\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:us-east-1:246512022090:instance/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:subnet/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:volume/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:network-interface/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:key-pair/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:security-group/*\"\n      ]\n    }\n  ]\n}",
            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"StartContinuousAssessmentLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"${managed_instance_iam_role}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:StartAutomationExecution\",\n      \"Resource\": [\n        \"arn:aws:ssm:${region}:${account}:automation-definition/:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopyImage\",\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:createTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AMI-Type\",\n            \"ProductName\",\n            \"continuous-assessment-instance\",\n            \"ProductOSAndVersion\",\n            \"version\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssociateIamInstanceProfile\"\n      ],\n      \"Resource\": [\n        \"${managed_instance_iam_role}\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:${region}::image/ami-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AMI-Type\": \"Golden\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:${region}:${account}:instance/*\",\n        \"arn:aws:ec2:${region}:${account}:subnet/*\",\n        \"arn:aws:ec2:${region}:${account}:volume/*\",\n        \"arn:aws:ec2:${region}:${account}:network-interface/*\",\n        \"arn:aws:ec2:${region}:${account}:key-pair/*\",\n        \"arn:aws:ec2:${region}:${account}:security-group/*\"\n      ]\n    }\n  ]\n}",
            "vars": {
              "account": "246512022090",
              "golden_ami_parameter": "arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*",
              "managed_instance_iam_role": "arn:aws:iam::246512022090:role/terraform-20210907105437466900000001",
              "region": "us-east-1"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "schedule",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:events:us-east-1:246512022090:rule/terraform-20210907105437512500000003",
            "description": "",
            "event_bus_name": "default",
            "event_pattern": null,
            "id": "terraform-20210907105437512500000003",
            "is_enabled": true,
            "name": "terraform-20210907105437512500000003",
            "name_prefix": "terraform-",
            "role_arn": "",
            "schedule_expression": "rate(1 day)",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-setup_continuous_assessment",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "http_target": [],
            "id": "terraform-20210907105437512500000003-TargetFunctionV1",
            "input": "{\"AMIsParamName\":\"/GoldenAMI/latest\", \"instanceType\":\"t3.large\"}",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "",
            "rule": "terraform-20210907105437512500000003",
            "run_command_targets": [],
            "sqs_target": [],
            "target_id": "TargetFunctionV1"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this",
            "module.scanner.aws_inspector_assessment_target.this",
            "module.scanner.data.template_file.run_continuous_inspection",
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.scanner.module.setup_continuous_assessment.aws_lambda_function.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_cloudwatch_event_rule.schedule",
            "module.scanner.data.archive_file.setup_continuous_assessment",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_subnet.public",
            "module.scanner.aws_iam_role.automation_service",
            "module.scanner.aws_ssm_document.run_continuous_inspection",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.vpc.aws_route_table.private",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.aws_inspector_resource_group.this",
            "module.vpc.aws_security_group.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_instance_profile",
      "name": "automation_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:instance-profile/automation_service_profile",
            "create_date": "2021-09-07T10:55:02Z",
            "id": "automation_service_profile",
            "name": "automation_service_profile",
            "name_prefix": null,
            "path": "/",
            "role": "terraform-20210907105437499900000002",
            "tags": {},
            "tags_all": {},
            "unique_id": "AIPATSZKC6JFAPFZF622A"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.aws_iam_role.automation_service",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_instance_profile",
      "name": "managed_instance",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:instance-profile/managed_instance_profile",
            "create_date": "2021-09-07T10:55:08Z",
            "id": "managed_instance_profile",
            "name": "managed_instance_profile",
            "name_prefix": null,
            "path": "/",
            "role": "terraform-20210907105437466900000001",
            "tags": {},
            "tags_all": {},
            "unique_id": "AIPATSZKC6JFEZS64DJ4D"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.scanner.aws_iam_role.managed_instance",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "automation_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/automation_service-policy",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/automation_service-policy",
            "name": "automation_service-policy",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:InvokeFunction\",\n      \"Resource\": [\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version\",\n        \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment\"\n      ]\n    }\n  ]\n}\n",
            "policy_id": "ANPATSZKC6JFHFED7ZXH5",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.archive_file.decommission_ami_version",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.scanner.module.append_ssm_param.aws_lambda_function.this",
            "module.scanner.module.decommision_ami_version.aws_iam_role.execution-role",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.data.archive_file.publish_ami_lambda_artifact",
            "module.scanner.module.publish_ami_lambda.aws_lambda_function.this",
            "module.vpc.aws_subnet.private",
            "module.scanner.data.template_file.automation_service",
            "module.scanner.module.decommision_ami_version.aws_lambda_function.this",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_route_table.public",
            "module.scanner.data.archive_file.run_inspector",
            "module.scanner.module.publish_ami_lambda.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.scanner.module.run_inspector.aws_lambda_function.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.archive_file.append_ssm_param",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "managed_instance",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/managed_instance-policy",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/managed_instance-policy",
            "name": "managed_instance-policy",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Action\": [\n      \"s3:*\"\n    ],\n    \"Effect\": \"Allow\",\n    \"Resource\": [\n      \"arn:aws:s3:::salesforce-ami-config-bucket/*\",\n      \"arn:aws:s3:::salesforce-ami-config-bucket\"\n    ]\n  }\n}",
            "policy_id": "ANPATSZKC6JFJFZZN7TFV",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.managed_instance",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "automation_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/terraform-20210907105437499900000002",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"ec2.amazonaws.com\",\"ssm.amazonaws.com\"]},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:38Z",
            "description": "",
            "force_detach_policies": false,
            "id": "terraform-20210907105437499900000002",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/automation_service-policy",
              "arn:aws:iam::aws:policy/service-role/AmazonSSMAutomationRole"
            ],
            "max_session_duration": 3600,
            "name": "terraform-20210907105437499900000002",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFESVRVUDYC"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_security_group.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "managed_instance",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/terraform-20210907105437466900000001",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"ec2.amazonaws.com\",\"ssm.amazonaws.com\"]},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:38Z",
            "description": "",
            "force_detach_policies": false,
            "id": "terraform-20210907105437466900000001",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/managed_instance-policy",
              "arn:aws:iam::aws:policy/service-role/AmazonEC2RoleforSSM"
            ],
            "max_session_duration": 3600,
            "name": "terraform-20210907105437466900000001",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFDF4PUNTJU"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "automation_service_attachment1",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "terraform-20210907105437499900000002-2021090710563890880000001a",
            "policy_arn": "arn:aws:iam::246512022090:policy/automation_service-policy",
            "role": "terraform-20210907105437499900000002"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_iam_role.automation_service",
            "module.scanner.data.archive_file.run_inspector",
            "module.scanner.module.append_ssm_param.aws_lambda_function.this",
            "module.scanner.module.publish_ami_lambda.aws_lambda_function.this",
            "module.scanner.data.archive_file.decommission_ami_version",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.scanner.module.decommision_ami_version.aws_iam_role.execution-role",
            "module.scanner.module.publish_ami_lambda.aws_iam_role.execution-role",
            "module.scanner.module.run_inspector.aws_lambda_function.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.aws_iam_policy.automation_service",
            "module.scanner.data.archive_file.append_ssm_param",
            "module.scanner.module.decommision_ami_version.aws_lambda_function.this",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.template_file.automation_service",
            "module.scanner.data.archive_file.publish_ami_lambda_artifact",
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "automation_service_attachment2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "terraform-20210907105437499900000002-20210907105504571800000005",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonSSMAutomationRole",
            "role": "terraform-20210907105437499900000002"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_iam_role.automation_service",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "managed_instance_attachment1",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "terraform-20210907105437466900000001-20210907105508639200000006",
            "policy_arn": "arn:aws:iam::246512022090:policy/managed_instance-policy",
            "role": "terraform-20210907105437466900000001"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.scanner.data.template_file.managed_instance",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.scanner.aws_iam_policy.managed_instance",
            "module.scanner.aws_iam_role.managed_instance"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "managed_instance_attachment2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "terraform-20210907105437466900000001-20210907105508658300000007",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonEC2RoleforSSM",
            "role": "terraform-20210907105437466900000001"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_iam_role.managed_instance",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_inspector_assessment_target",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:inspector:us-east-1:246512022090:target/0-7U8w7ZDt",
            "id": "arn:aws:inspector:us-east-1:246512022090:target/0-7U8w7ZDt",
            "name": "continuous assessment target",
            "resource_group_arn": "arn:aws:inspector:us-east-1:246512022090:resourcegroup/0-KSbNvijy"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_inspector_resource_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_inspector_resource_group",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:inspector:us-east-1:246512022090:resourcegroup/0-KSbNvijy",
            "id": "arn:aws:inspector:us-east-1:246512022090:resourcegroup/0-KSbNvijy",
            "tags": {
              "Env": "True",
              "Name": "continuous-assessment-instance"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_cloudwatch",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-setup_continuous_assessment",
            "id": "AllowExecutionFromCloudwatch",
            "principal": "events.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:events:us-east-1:246512022090:rule/terraform-20210907105437512500000003",
            "statement_id": "AllowExecutionFromCloudwatch",
            "statement_id_prefix": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.data.archive_file.setup_continuous_assessment",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.aws_inspector_assessment_target.this",
            "module.scanner.data.template_file.run_continuous_inspection",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_inspector_resource_group.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.scanner.aws_ssm_document.run_continuous_inspection",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.scanner.aws_iam_role.automation_service",
            "module.vpc.aws_route.private_internet",
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.scanner.module.setup_continuous_assessment.aws_lambda_function.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.scanner.aws_cloudwatch_event_rule.schedule",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.vpc.aws_security_group_rule.ingress"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_sns1",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "salesforce-assess_assessment",
            "id": "AllowExecutionFromSNS",
            "principal": "sns.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "statement_id": "AllowExecutionFromSNS",
            "statement_id_prefix": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.assess_assessment.aws_iam_role.execution-role",
            "module.scanner.module.assess_assessment.aws_lambda_function.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.data.archive_file.assess_assessment",
            "module.scanner.module.approver_topic.aws_sns_topic.this",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_sns2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "salesforce-analyse_findings",
            "id": "AllowExecutionFromSNS",
            "principal": "sns.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
            "statement_id": "AllowExecutionFromSNS",
            "statement_id_prefix": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.scanner.module.analyse_findings.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.archive_file.analyse_findings",
            "module.scanner.module.analyse_findings.aws_lambda_function.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "assessment_result",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": null,
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": null,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": null,
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": null,
            "name": "salesforce-assessment_result",
            "name_prefix": "",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\",\"SNS:Receive\"],\"Resource\":\"arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result\",\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"246512022090\"}}}]}",
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": null,
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "email",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result:a40da64c-256a-4b3c-89da-43df1b7d7bea",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "sridhar.mundra@gmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result:a40da64c-256a-4b3c-89da-43df1b7d7bea",
            "owner_id": "246512022090",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_ssm_document",
      "name": "decommision_ami_version",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ssm:us-east-1:246512022090:document/decommision_ami_version",
            "attachments_source": [],
            "content": "{\n  \"description\": \"This automation document triggers golden AMI build decommissioning workflow\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"bucketName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains name of the bucket in which CFT template file is stored\",\n      \"default\": \"arn:aws:s3:::salesforce-ami-config-bucket\"\n    },\n    \"templateFileName\": {\n      \"type\": \"String\",\n      \"description\": \"The CFT template file-name used for creating the Service Catalog product\",\n      \"default\": \"simpleEC2-SSMParamInput.json\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion\",\n      \"default\": \"salesforce\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n      \"default\": \"Windows_Server-20H2-English-Core-Base-2021.05.12\"\n    },\n    \"buildVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI build number to be decommissioned.\",\n      \"default\": \"1.0\"\n    },\n    \"MetadataParamName\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter points to an SSM parameter used for storing some process specific metadata. Do not change the default value.\",\n      \"default\": \"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{buildVersion}}/temp\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"DecommissionAMIVersionLambda\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version\",\n        \"Payload\": \"{\\\"bucketName\\\":\\\"{{ bucketName }}\\\", \\\"amiRegionMappingParamName\\\":\\\"{{ MetadataParamName }}\\\", \\\"templateFileName\\\":\\\"{{templateFileName}}\\\", \\\"versionToBeDeleted\\\":\\\"{{ buildVersion }}\\\", \\\"productOSAndVersion\\\":\\\"{{ productOSAndVersion }}\\\", \\\"productNameAndVersion\\\":\\\"{{ productName }}\\\"}\"\n      }\n    }\n  ]\n}",
            "created_date": "2021-09-07T10:59:32Z",
            "default_version": "1",
            "description": "This automation document triggers golden AMI build decommissioning workflow",
            "document_format": "JSON",
            "document_type": "Automation",
            "document_version": "1",
            "hash": "986f51b45bbc6e30377f5f38b41780975d6dbed682466173822b264d9b8e47d8",
            "hash_type": "Sha256",
            "id": "decommision_ami_version",
            "latest_version": "1",
            "name": "decommision_ami_version",
            "owner": "246512022090",
            "parameter": [
              {
                "default_value": "arn:aws:s3:::salesforce-ami-config-bucket",
                "description": "This parameter contains name of the bucket in which CFT template file is stored",
                "name": "bucketName",
                "type": "String"
              },
              {
                "default_value": "simpleEC2-SSMParamInput.json",
                "description": "The CFT template file-name used for creating the Service Catalog product",
                "name": "templateFileName",
                "type": "String"
              },
              {
                "default_value": "salesforce",
                "description": "The syntax of this parameter is ProductName-ProductVersion",
                "name": "productName",
                "type": "String"
              },
              {
                "default_value": "Windows_Server-20H2-English-Core-Base-2021.05.12",
                "description": "The syntax of this parameter is OSName-OSVersion",
                "name": "productOSAndVersion",
                "type": "String"
              },
              {
                "default_value": "1.0",
                "description": "Golden AMI build number to be decommissioned.",
                "name": "buildVersion",
                "type": "String"
              },
              {
                "default_value": "/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{buildVersion}}/temp",
                "description": "This parameter points to an SSM parameter used for storing some process specific metadata. Do not change the default value.",
                "name": "MetadataParamName",
                "type": "String"
              }
            ],
            "permissions": null,
            "platform_types": [
              "Windows",
              "Linux",
              "MacOS"
            ],
            "schema_version": "0.3",
            "status": "Active",
            "tags": null,
            "tags_all": {},
            "target_type": "",
            "version_name": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.decommision_ami_version_doc",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_ssm_document",
      "name": "golden_ami_automation",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ssm:us-east-1:246512022090:document/golden_ami_automation",
            "attachments_source": [],
            "content": "{\n  \"description\": \"This automation document triggers Golden AMI creation workflow.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"sourceAMIid\": {\n      \"type\": \"String\",\n      \"description\": \"Source/Base AMI to be used for generating your golden AMI\",\n      \"default\": \"{{ssm:/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2}}\"\n    },\n    \"productName\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is ProductName-ProductVersion.\",\n      \"default\": \"salesforce\"\n    },\n    \"productOSAndVersion\": {\n      \"type\": \"String\",\n      \"description\": \"The syntax of this parameter is OSName-OSVersion\",\n       \"default\": \"Windows_Server-20H2-English-Core-Base-2021.05.12\"\n    },\n    \"ApproverARN\": {\n      \"type\": \"String\",\n      \"description\": \"AWS authenticated principals who are able to either approve or reject the Golden AMI. You can specify principals by using an AWS Identity and Access Management (IAM) user name, IAM user ARN, IAM role ARN, or an IAM assume role user ARN.\",\n      \"default\": \"abc\"\n    },\n    \"ApproverNotificationArn\": {\n      \"type\": \"String\",\n      \"description\": \"SNS Topic ARN on which a notification would be published once the golden AMI candidate is ready for validation.\",\n      \"default\": \"arn:aws:sns:us-east-1:246512022090:salesforce-approver\"\n    },\n    \"AMIVersion\": {\n      \"type\": \"String\",\n      \"description\": \"Golden AMI Build version number to be created.\",\n      \"default\": \"1.0\"\n    },\n    \"subnetId\": {\n      \"type\": \"String\",\n      \"default\": \"arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f\",\n      \"description\": \"Subnet in which instances will be launched.\"\n    },\n    \"securityGroupId\": {\n      \"type\": \"String\",\n      \"default\": \"sg-0eb183a7c40d99209\",\n      \"description\": \"Security Group that will be attached to the instance. By Default a security group without any inbound access is attached\"\n    },\n    \"instanceType\": {\n      \"type\": \"String\",\n      \"description\": \"A compatible instance-type for launching an instance\",\n      \"default\": \"t3.large\"\n    },\n    \"targetAMIname\": {\n      \"type\": \"String\",\n      \"description\": \"Name for the golden AMI to be created\",\n      \"default\": \"{{productName}}-{{productOSAndVersion}}-{{AMIVersion}}\"\n    },\n    \"ManagedInstanceProfile\": {\n      \"type\": \"String\",\n      \"description\": \"Instance Profile. Do not change the default value.\",\n      \"default\": \"arn:aws:iam::246512022090:instance-profile/managed_instance_profile\"\n    },\n    \"SSMInstallationUserData\": {\n      \"type\": \"String\",\n      \"description\": \"Base64 encoded SSM installation user-data.\",\n      \"default\": \"IyEvYmluL2Jhc2gNCg0KZnVuY3Rpb24gZ2V0X2NvbnRlbnRzKCkgew0KICAgIGlmIFsgLXggIiQod2hpY2ggY3VybCkiIF07IHRoZW4NCiAgICAgICAgY3VybCAtcyAtZiAiJDEiDQogICAgZWxpZiBbIC14ICIkKHdoaWNoIHdnZXQpIiBdOyB0aGVuDQogICAgICAgIHdnZXQgIiQxIiAtTyAtDQogICAgZWxzZQ0KICAgICAgICBkaWUgIk5vIGRvd25sb2FkIHV0aWxpdHkgKGN1cmwsIHdnZXQpIg0KICAgIGZpDQp9DQoNCnJlYWRvbmx5IElERU5USVRZX1VSTD0iaHR0cDovLzE2OS4yNTQuMTY5LjI1NC8yMDE2LTA2LTMwL2R5bmFtaWMvaW5zdGFuY2UtaWRlbnRpdHkvZG9jdW1lbnQvIg0KcmVhZG9ubHkgVFJVRV9SRUdJT049JChnZXRfY29udGVudHMgIiRJREVOVElUWV9VUkwiIHwgYXdrIC1GXCIgJy9yZWdpb24vIHsgcHJpbnQgJDQgfScpDQpyZWFkb25seSBERUZBVUxUX1JFR0lPTj0idXMtZWFzdC0xIg0KcmVhZG9ubHkgUkVHSU9OPSIke1RSVUVfUkVHSU9OOi0kREVGQVVMVF9SRUdJT059Ig0KDQpyZWFkb25seSBTQ1JJUFRfTkFNRT0iYXdzLWluc3RhbGwtc3NtLWFnZW50Ig0KIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5hbWF6b25hd3MuY29tL3NjcmlwdHMvJFNDUklQVF9OQU1FIg0KDQppZiBbICIkUkVHSU9OIiA9ICJjbi1ub3J0aC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5jbi1ub3J0aC0xLmFtYXpvbmF3cy5jb20uY24vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQppZiBbICIkUkVHSU9OIiA9ICJ1cy1nb3Ytd2VzdC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy11cy1nb3Ytd2VzdC0xLmFtYXpvbmF3cy5jb20vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQpjZCAvdG1wDQpGSUxFX1NJWkU9MA0KTUFYX1JFVFJZX0NPVU5UPTMNClJFVFJZX0NPVU5UPTANCg0Kd2hpbGUgWyAkUkVUUllfQ09VTlQgLWx0ICRNQVhfUkVUUllfQ09VTlQgXSA7IGRvDQogIGVjaG8gQVdTLVVwZGF0ZUxpbnV4QW1pOiBEb3dubG9hZGluZyBzY3JpcHQgZnJvbSAkU0NSSVBUX1VSTA0KICBnZXRfY29udGVudHMgIiRTQ1JJUFRfVVJMIiA+ICIkU0NSSVBUX05BTUUiDQogIEZJTEVfU0laRT0kKGR1IC1rIC90bXAvJFNDUklQVF9OQU1FIHwgY3V0IC1mMSkNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbmlzaGVkIGRvd25sb2FkaW5nIHNjcmlwdCwgc2l6ZTogJEZJTEVfU0laRQ0KICBpZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICAgIGJyZWFrDQogIGVsc2UNCiAgICBpZiBbWyAkUkVUUllfQ09VTlQgLWx0IE1BWF9SRVRSWV9DT1VOVCBdXTsgdGhlbg0KICAgICAgUkVUUllfQ09VTlQ9JCgoUkVUUllfQ09VTlQrMSkpOw0KICAgICAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbGVTaXplIGlzIDAsIHJldHJ5Q291bnQ6ICRSRVRSWV9DT1VOVA0KICAgIGZpDQogIGZpIA0KZG9uZQ0KDQppZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICBjaG1vZCAreCAiJFNDUklQVF9OQU1FIg0KICBlY2hvIEFXUy1VcGRhdGVMaW51eEFtaTogUnVubmluZyBVcGRhdGVTU01BZ2VudCBzY3JpcHQgbm93IC4uLi4NCiAgLi8iJFNDUklQVF9OQU1FIiAtLXJlZ2lvbiAiJFJFR0lPTiINCmVsc2UNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IFVuYWJsZSB0byBkb3dubG9hZCBzY3JpcHQsIHF1aXR0aW5nIC4uLi4NCmZp\"\n    },\n    \"PreUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run before updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"PostUpdateScript\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) URL of a script to run after package updates are applied. Default (\\\"none\\\") is to not run a script.\",\n      \"default\": \"none\"\n    },\n    \"IncludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Only update these named packages. By default (\\\"all\\\"), all available updates are applied.\",\n      \"default\": \"all\"\n    },\n    \"ExcludePackages\": {\n      \"type\": \"String\",\n      \"description\": \"(Optional) Names of packages to hold back from updates, under all conditions. By default (\\\"none\\\"), no package is excluded.\",\n      \"default\": \"none\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"startInstances\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 3600,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ sourceAMIid }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"UserData\": \"{{SSMInstallationUserData}}\",\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"updateSSMAgent\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-UpdateSSMAgent\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"describeInstance\",\n      \"action\": \"aws:executeAwsApi\",\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"Service\": \"ec2\",\n        \"Api\": \"DescribeInstances\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"outputs\": [\n        {\n          \"Name\": \"Platform\",\n          \"Selector\": \"$.Reservations[0].Instances[0].Platform\",\n          \"Type\": \"String\"\n        }\n      ],\n      \"nextStep\": \"branchOnInstancePlatform\"\n    },\n    {\n      \"name\": \"branchOnInstancePlatform\",\n      \"action\": \"aws:branch\",\n      \"inputs\": {\n        \"Choices\": [\n          {\n            \"NextStep\": \"installWindowsUpdates\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"windows\"\n          },\n          {\n            \"NextStep\": \"updateOSSoftware\",\n            \"Variable\": \"{{ describeInstance.Platform }}\",\n            \"StringEquals\": \"linux\"\n          }\n        ],\n        \"Default\": \"updateOSSoftware\"\n      }\n    },\n    {\n      \"name\": \"installWindowsUpdates\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"onFailure\": \"Abort\",\n      \"timeoutSeconds\": 14400,\n      \"inputs\": {\n        \"DocumentName\": \"AWS-InstallWindowsUpdates\",\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ]\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"updateOSSoftware\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AWS-RunShellScript\",\n        \"InstanceIds\": [\n          \"{{startInstances.InstanceIds}}\"\n        ],\n        \"Parameters\": {\n          \"commands\": [\n            \"set -e\",\n            \"[ -x \\\"$(which wget)\\\" ] \u0026\u0026 get_contents='wget $1 -O -'\",\n            \"[ -x \\\"$(which curl)\\\" ] \u0026\u0026 get_contents='curl -s -f $1'\",\n            \"eval $get_contents https://aws-ssm-downloads-{{global:REGION}}.s3.amazonaws.com/scripts/aws-update-linux-instance \u003e /tmp/aws-update-linux-instance\",\n            \"chmod +x /tmp/aws-update-linux-instance\",\n            \"/tmp/aws-update-linux-instance --pre-update-script '{{PreUpdateScript}}' --post-update-script '{{PostUpdateScript}}' --include-packages '{{IncludePackages}}' --exclude-packages '{{ExcludePackages}}' 2\u003e\u00261 | tee /tmp/aws-update-linux-instance.log\"\n          ]\n        }\n      },\n      \"nextStep\": \"stopInstance\"\n    },\n    {\n      \"name\": \"stopInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"stopped\"\n      }\n    },\n    {\n      \"name\": \"createImage\",\n      \"action\": \"aws:createImage\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceId\": \"{{ startInstances.InstanceIds }}\",\n        \"ImageName\": \"{{ targetAMIname }}\",\n        \"NoReboot\": true,\n        \"ImageDescription\": \"AMI created by EC2 Automation\"\n      }\n    },\n    {\n      \"name\": \"TagTheAMI\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createImage.ImageId }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"ProductOSAndVersion\",\n            \"Value\": \"{{productOSAndVersion}}\"\n          },\n          {\n            \"Key\": \"ProductName\",\n            \"Value\": \"{{productName}}\"\n          },\n          {\n            \"Key\": \"version\",\n            \"Value\": \"{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"AMI-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"terminateFirstInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ startInstances.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"createInstanceFromNewImage\",\n      \"action\": \"aws:runInstances\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"ImageId\": \"{{ createImage.ImageId }}\",\n        \"InstanceType\": \"{{instanceType}}\",\n        \"MinInstanceCount\": 1,\n        \"MaxInstanceCount\": 1,\n        \"SubnetId\": \"{{ subnetId }}\",\n        \"SecurityGroupIds\": [\n          \"{{ securityGroupId }}\"\n        ],\n        \"IamInstanceProfileName\": \"{{ ManagedInstanceProfile }}\"\n      }\n    },\n    {\n      \"name\": \"InstallInspector\",\n      \"action\": \"aws:runCommand\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 3600,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"DocumentName\": \"AmazonInspector-ManageAWSAgent\",\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Parameters\": {\n          \"Operation\": \"Install\"\n        }\n      }\n    },\n    {\n      \"name\": \"TagNewinstance\",\n      \"action\": \"aws:createTags\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"ResourceType\": \"EC2\",\n        \"ResourceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"Tags\": [\n          {\n            \"Key\": \"Type\",\n            \"Value\": \"{{createImage.ImageId}}-{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\"\n          },\n          {\n            \"Key\": \"Automation-Instance-Type\",\n            \"Value\": \"Golden\"\n          }\n        ]\n      }\n    },\n    {\n      \"name\": \"InspectBaseInstance\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"maxAttempts\": 3,\n      \"timeoutSeconds\": 120,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector\",\n        \"Payload\": \"{\\\"AMI-ID\\\": \\\"{{createImage.ImageId}}\\\",\\\"topicArn\\\":\\\"arn:aws:sns:us-east-1:246512022090:salesforce-approver\\\",\\\"instanceId\\\": \\\"{{ createInstanceFromNewImage.InstanceIds }}\\\",\\\"productOS\\\": \\\"{{productOSAndVersion}}\\\",\\\"productName\\\": \\\"{{productName}}\\\",\\\"productVersion\\\": \\\"{{AMIVersion}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT2M\"\n      }\n    },\n    {\n      \"name\": \"terminateInspectorInstance\",\n      \"action\": \"aws:changeInstanceState\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Continue\",\n      \"inputs\": {\n        \"InstanceIds\": [\n          \"{{ createInstanceFromNewImage.InstanceIds }}\"\n        ],\n        \"DesiredState\": \"terminated\"\n      }\n    },\n    {\n      \"name\": \"addNewVersionParameter\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    },\n    {\n      \"name\": \"approve\",\n      \"action\": \"aws:approve\",\n      \"timeoutSeconds\": 172800,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"NotificationArn\": \"{{ ApproverNotificationArn }}\",\n        \"Message\": \"Please check contents of SSM Parameter : /GoldenAMI/{{productOSAndVersion}}/{{productName}}/{{AMIVersion}}/NumCVEs and approve/deny the build.\",\n        \"MinRequiredApprovals\": 1,\n        \"Approvers\": [\n          \"{{ ApproverARN }}\"\n        ]\n      }\n    },\n    {\n      \"name\": \"updateLatestVersionValue\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\":  \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param\",\n        \"Payload\": \"{\\\"parameterName\\\":\\\"/GoldenAMI/latest\\\", \\\"valueToBeCreatedOrAppended\\\":\\\"{{createImage.ImageId}}\\\"}\"\n      }\n    }\n  ],\n  \"outputs\": [\n    \"createImage.ImageId\"\n  ]\n}",
            "created_date": "2021-09-07T10:55:56Z",
            "default_version": "1",
            "description": "This automation document triggers Golden AMI creation workflow.",
            "document_format": "JSON",
            "document_type": "Automation",
            "document_version": "1",
            "hash": "55e2428a2d87d41ae5898fad3af91a57587c50a7baa90fb2e347542390d30874",
            "hash_type": "Sha256",
            "id": "golden_ami_automation",
            "latest_version": "1",
            "name": "golden_ami_automation",
            "owner": "246512022090",
            "parameter": [
              {
                "default_value": "{{ssm:/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2}}",
                "description": "Source/Base AMI to be used for generating your golden AMI",
                "name": "sourceAMIid",
                "type": "String"
              },
              {
                "default_value": "salesforce",
                "description": "The syntax of this parameter is ProductName-ProductVersion.",
                "name": "productName",
                "type": "String"
              },
              {
                "default_value": "Windows_Server-20H2-English-Core-Base-2021.05.12",
                "description": "The syntax of this parameter is OSName-OSVersion",
                "name": "productOSAndVersion",
                "type": "String"
              },
              {
                "default_value": "abc",
                "description": "AWS authenticated principals who are able to either approve or reject the Golden AMI. You can specify principals by using an AWS Identity and Access Management (IAM) user name, IAM user ARN, IAM role ARN, or an IAM assume role user ARN.",
                "name": "ApproverARN",
                "type": "String"
              },
              {
                "default_value": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
                "description": "SNS Topic ARN on which a notification would be published once the golden AMI candidate is ready for validation.",
                "name": "ApproverNotificationArn",
                "type": "String"
              },
              {
                "default_value": "1.0",
                "description": "Golden AMI Build version number to be created.",
                "name": "AMIVersion",
                "type": "String"
              },
              {
                "default_value": "arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f",
                "description": "Subnet in which instances will be launched.",
                "name": "subnetId",
                "type": "String"
              },
              {
                "default_value": "sg-0eb183a7c40d99209",
                "description": "Security Group that will be attached to the instance. By Default a security group without any inbound access is attached",
                "name": "securityGroupId",
                "type": "String"
              },
              {
                "default_value": "t3.large",
                "description": "A compatible instance-type for launching an instance",
                "name": "instanceType",
                "type": "String"
              },
              {
                "default_value": "{{productName}}-{{productOSAndVersion}}-{{AMIVersion}}",
                "description": "Name for the golden AMI to be created",
                "name": "targetAMIname",
                "type": "String"
              },
              {
                "default_value": "arn:aws:iam::246512022090:instance-profile/managed_instance_profile",
                "description": "Instance Profile. Do not change the default value.",
                "name": "ManagedInstanceProfile",
                "type": "String"
              },
              {
                "default_value": "IyEvYmluL2Jhc2gNCg0KZnVuY3Rpb24gZ2V0X2NvbnRlbnRzKCkgew0KICAgIGlmIFsgLXggIiQod2hpY2ggY3VybCkiIF07IHRoZW4NCiAgICAgICAgY3VybCAtcyAtZiAiJDEiDQogICAgZWxpZiBbIC14ICIkKHdoaWNoIHdnZXQpIiBdOyB0aGVuDQogICAgICAgIHdnZXQgIiQxIiAtTyAtDQogICAgZWxzZQ0KICAgICAgICBkaWUgIk5vIGRvd25sb2FkIHV0aWxpdHkgKGN1cmwsIHdnZXQpIg0KICAgIGZpDQp9DQoNCnJlYWRvbmx5IElERU5USVRZX1VSTD0iaHR0cDovLzE2OS4yNTQuMTY5LjI1NC8yMDE2LTA2LTMwL2R5bmFtaWMvaW5zdGFuY2UtaWRlbnRpdHkvZG9jdW1lbnQvIg0KcmVhZG9ubHkgVFJVRV9SRUdJT049JChnZXRfY29udGVudHMgIiRJREVOVElUWV9VUkwiIHwgYXdrIC1GXCIgJy9yZWdpb24vIHsgcHJpbnQgJDQgfScpDQpyZWFkb25seSBERUZBVUxUX1JFR0lPTj0idXMtZWFzdC0xIg0KcmVhZG9ubHkgUkVHSU9OPSIke1RSVUVfUkVHSU9OOi0kREVGQVVMVF9SRUdJT059Ig0KDQpyZWFkb25seSBTQ1JJUFRfTkFNRT0iYXdzLWluc3RhbGwtc3NtLWFnZW50Ig0KIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5hbWF6b25hd3MuY29tL3NjcmlwdHMvJFNDUklQVF9OQU1FIg0KDQppZiBbICIkUkVHSU9OIiA9ICJjbi1ub3J0aC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy5jbi1ub3J0aC0xLmFtYXpvbmF3cy5jb20uY24vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQppZiBbICIkUkVHSU9OIiA9ICJ1cy1nb3Ytd2VzdC0xIiBdOyB0aGVuDQogIFNDUklQVF9VUkw9Imh0dHBzOi8vYXdzLXNzbS1kb3dubG9hZHMtJFJFR0lPTi5zMy11cy1nb3Ytd2VzdC0xLmFtYXpvbmF3cy5jb20vc2NyaXB0cy8kU0NSSVBUX05BTUUiDQpmaQ0KDQpjZCAvdG1wDQpGSUxFX1NJWkU9MA0KTUFYX1JFVFJZX0NPVU5UPTMNClJFVFJZX0NPVU5UPTANCg0Kd2hpbGUgWyAkUkVUUllfQ09VTlQgLWx0ICRNQVhfUkVUUllfQ09VTlQgXSA7IGRvDQogIGVjaG8gQVdTLVVwZGF0ZUxpbnV4QW1pOiBEb3dubG9hZGluZyBzY3JpcHQgZnJvbSAkU0NSSVBUX1VSTA0KICBnZXRfY29udGVudHMgIiRTQ1JJUFRfVVJMIiA+ICIkU0NSSVBUX05BTUUiDQogIEZJTEVfU0laRT0kKGR1IC1rIC90bXAvJFNDUklQVF9OQU1FIHwgY3V0IC1mMSkNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbmlzaGVkIGRvd25sb2FkaW5nIHNjcmlwdCwgc2l6ZTogJEZJTEVfU0laRQ0KICBpZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICAgIGJyZWFrDQogIGVsc2UNCiAgICBpZiBbWyAkUkVUUllfQ09VTlQgLWx0IE1BWF9SRVRSWV9DT1VOVCBdXTsgdGhlbg0KICAgICAgUkVUUllfQ09VTlQ9JCgoUkVUUllfQ09VTlQrMSkpOw0KICAgICAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IEZpbGVTaXplIGlzIDAsIHJldHJ5Q291bnQ6ICRSRVRSWV9DT1VOVA0KICAgIGZpDQogIGZpIA0KZG9uZQ0KDQppZiBbICRGSUxFX1NJWkUgLWd0IDAgXTsgdGhlbg0KICBjaG1vZCAreCAiJFNDUklQVF9OQU1FIg0KICBlY2hvIEFXUy1VcGRhdGVMaW51eEFtaTogUnVubmluZyBVcGRhdGVTU01BZ2VudCBzY3JpcHQgbm93IC4uLi4NCiAgLi8iJFNDUklQVF9OQU1FIiAtLXJlZ2lvbiAiJFJFR0lPTiINCmVsc2UNCiAgZWNobyBBV1MtVXBkYXRlTGludXhBbWk6IFVuYWJsZSB0byBkb3dubG9hZCBzY3JpcHQsIHF1aXR0aW5nIC4uLi4NCmZp",
                "description": "Base64 encoded SSM installation user-data.",
                "name": "SSMInstallationUserData",
                "type": "String"
              },
              {
                "default_value": "none",
                "description": "(Optional) URL of a script to run before updates are applied. Default (\"none\") is to not run a script.",
                "name": "PreUpdateScript",
                "type": "String"
              },
              {
                "default_value": "none",
                "description": "(Optional) URL of a script to run after package updates are applied. Default (\"none\") is to not run a script.",
                "name": "PostUpdateScript",
                "type": "String"
              },
              {
                "default_value": "all",
                "description": "(Optional) Only update these named packages. By default (\"all\"), all available updates are applied.",
                "name": "IncludePackages",
                "type": "String"
              },
              {
                "default_value": "none",
                "description": "(Optional) Names of packages to hold back from updates, under all conditions. By default (\"none\"), no package is excluded.",
                "name": "ExcludePackages",
                "type": "String"
              }
            ],
            "permissions": {},
            "platform_types": [
              "Windows",
              "Linux",
              "MacOS"
            ],
            "schema_version": "0.3",
            "status": "Active",
            "tags": {},
            "tags_all": {},
            "target_type": "",
            "version_name": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.aws_iam_instance_profile.managed_instance",
            "module.scanner.aws_iam_role.automation_service",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.scanner.module.run_inspector.aws_lambda_function.this",
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.scanner.module.append_ssm_param.aws_lambda_function.this",
            "module.scanner.module.approver_topic.aws_sns_topic.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_security_group.this",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.module.inspector_complete.aws_sns_topic.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_route_table_association.public",
            "module.scanner.data.archive_file.run_inspector",
            "module.vpc.aws_route.internet",
            "module.scanner.data.template_file.golden_ami_automation",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.archive_file.append_ssm_param"
          ]
        }
      ]
    },
    {
      "module": "module.scanner",
      "mode": "managed",
      "type": "aws_ssm_document",
      "name": "run_continuous_inspection",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ssm:us-east-1:246512022090:document/run_continuous_inspection",
            "attachments_source": [],
            "content": "{\n  \"description\": \"This automation document is triggered as part of the continuous vulnerability assessment on all active golden AMIs.\",\n  \"schemaVersion\": \"0.3\",\n  \"assumeRole\": \"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\",\n  \"parameters\": {\n    \"instanceIDs\": {\n      \"type\": \"String\",\n      \"description\": \"This parameter contains list of instance-ids on which continuous vulnerability assessment is  performed.\"\n    }\n  },\n  \"mainSteps\": [\n    {\n      \"name\": \"sleep\",\n      \"action\": \"aws:sleep\",\n      \"inputs\": {\n        \"Duration\": \"PT6M\"\n      }\n    },\n    {\n      \"name\": \"InitiateAssessmentLambdaFunction\",\n      \"action\": \"aws:invokeLambdaFunction\",\n      \"timeoutSeconds\": 1200,\n      \"maxAttempts\": 1,\n      \"onFailure\": \"Abort\",\n      \"inputs\": {\n        \"FunctionName\": \"arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment\",\n        \"Payload\": \"{\\\"instanceIDs\\\":\\\"{{ instanceIDs }}\\\"}\"\n      }\n    }\n  ]\n}",
            "created_date": "2021-09-07T10:56:10Z",
            "default_version": "1",
            "description": "This automation document is triggered as part of the continuous vulnerability assessment on all active golden AMIs.",
            "document_format": "JSON",
            "document_type": "Automation",
            "document_version": "1",
            "hash": "da9b746ef63b35f40f7d8f51e35fb550c6e16fc772f87ab30095e6db7ed705eb",
            "hash_type": "Sha256",
            "id": "run_continuous_inspection",
            "latest_version": "1",
            "name": "run_continuous_inspection",
            "owner": "246512022090",
            "parameter": [
              {
                "default_value": "",
                "description": "This parameter contains list of instance-ids on which continuous vulnerability assessment is  performed.",
                "name": "instanceIDs",
                "type": "String"
              }
            ],
            "permissions": {},
            "platform_types": [
              "Windows",
              "Linux",
              "MacOS"
            ],
            "schema_version": "0.3",
            "status": "Active",
            "tags": {},
            "tags_all": {},
            "target_type": "",
            "version_name": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.scanner.data.template_file.run_continuous_inspection",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.scanner.aws_iam_role.automation_service",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.analyse_findings",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-analyse_findings-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-analyse_findings-lambda-additional-permission",
            "name": "salesforce-analyse_findings-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:AddAttributesToFindings\",\n        \"inspector:DescribeFindings\",\n        \"ec2:DescribeInstances\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sns:Publish\",\n      \"Resource\": [\"arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result\"]\n    },\n    {\n      \"Sid\": \"AnalyzeInspectorFindingsLambdaPolicyStmt3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/continuous-assessment-instance\": \"true\"\n        }\n      }\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFCIFA36POO",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.analyse_findings"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.analyse_findings",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-analyse_findings-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:45Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-analyse_findings-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-analyse_findings-lambda-additional-permission",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-analyse_findings-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFNDRWSQDHJ"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.analyse_findings",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-analyse_findings-lambda-execution-role-2021090710551464520000000a",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-analyse_findings-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.analyse_findings.aws_iam_role.execution-role",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.analyse_findings",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-analyse_findings-lambda-execution-role-20210907105541985800000013",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-analyse_findings-lambda-additional-permission",
            "role": "salesforce-analyse_findings-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_nat_gateway.nat",
            "module.scanner.data.template_file.analyse_findings",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.analyse_findings.aws_iam_policy.policy",
            "module.scanner.module.analyse_findings.aws_iam_role.execution-role",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.analyse_findings",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-analyse_findings",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "continuous_result_topic": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/analyse_findings.zip",
            "function_name": "salesforce-analyse_findings",
            "handler": "index.lambda_handler",
            "id": "salesforce-analyse_findings",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-analyse_findings/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:55:55.115+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-analyse_findings:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-analyse_findings-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "7iCyNOasAQkGl8SsYECxupVmbHxyw90SxVkP0yQcKNk=",
            "source_code_size": 1009,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.data.archive_file.analyse_findings",
            "module.scanner.module.analyse_findings.aws_iam_role.execution-role",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.append_ssm_param",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-append_ssm_param-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-append_ssm_param-lambda-additional-permission",
            "name": "salesforce-append_ssm_param-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    }\n  ]\n}\n\n",
            "policy_id": "ANPATSZKC6JFEVTTCIML2",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.template_file.append_ssm_param",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.append_ssm_param",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-append_ssm_param-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:38Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-append_ssm_param-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-append_ssm_param-lambda-additional-permission",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-append_ssm_param-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFENL2DB7M7"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.append_ssm_param",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-append_ssm_param-lambda-execution-role-20210907105457660200000004",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-append_ssm_param-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.append_ssm_param",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-append_ssm_param-lambda-execution-role-20210907105548151100000018",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-append_ssm_param-lambda-additional-permission",
            "role": "salesforce-append_ssm_param-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.scanner.module.append_ssm_param.aws_iam_policy.policy",
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.data.aws_caller_identity.this",
            "module.scanner.data.template_file.append_ssm_param",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.append_ssm_param",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/append_ssm_param.zip",
            "function_name": "salesforce-append_ssm_param",
            "handler": "index.lambda_handler",
            "id": "salesforce-append_ssm_param",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:54:56.611+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-append_ssm_param:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-append_ssm_param-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "qxg87sf3HCZ/DP1rl00VTuir5NQjvEySGmKal2X8xek=",
            "source_code_size": 529,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.append_ssm_param.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.scanner.data.archive_file.append_ssm_param",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.approver_topic",
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": null,
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": null,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": null,
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": null,
            "name": "salesforce-approver",
            "name_prefix": "",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"ApproverTopicPolicy\",\"Statement\":[{\"Sid\":\"ApproverTopicPolicySID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}",
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": null,
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.approver_topic",
      "mode": "managed",
      "type": "aws_sns_topic_policy",
      "name": "default",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"ApproverTopicPolicy\",\"Statement\":[{\"Sid\":\"ApproverTopicPolicySID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.private",
            "module.scanner.aws_iam_role.automation_service",
            "module.scanner.module.approver_topic.aws_sns_topic.this",
            "module.vpc.aws_route.internet",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.template_file.approver_topic",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_internet_gateway.igw"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.approver_topic",
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "email",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver:6fa0133b-0966-4398-8fd9-d356c8309f4f",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "sridhar.mundra@gmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver:6fa0133b-0966-4398-8fd9-d356c8309f4f",
            "owner_id": "246512022090",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.module.approver_topic.aws_sns_topic.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assess_assessment",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-assess_assessment-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-assess_assessment-lambda-additional-permission",
            "name": "salesforce-assess_assessment-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:DescribeAssessmentTemplates\",\n        \"inspector:DescribeFindings\",\n        \"inspector:ListFindings\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFAHFHZNGH3",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.template_file.assess_assessment",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assess_assessment",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-assess_assessment-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:56Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-assess_assessment-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-assess_assessment-lambda-additional-permission",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-assess_assessment-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFHN3E6LC6V"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assess_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-assess_assessment-lambda-execution-role-20210907105539948000000011",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-assess_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.scanner.module.assess_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assess_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-assess_assessment-lambda-execution-role-20210907105541955700000012",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-assess_assessment-lambda-additional-permission",
            "role": "salesforce-assess_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.assess_assessment",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.assess_assessment.aws_iam_policy.policy",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.scanner.module.assess_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assess_assessment",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-assess_assessment",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/assess_assessment.zip",
            "function_name": "salesforce-assess_assessment",
            "handler": "index.lambda_handler",
            "id": "salesforce-assess_assessment",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-assess_assessment/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:56:50.834+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-assess_assessment:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-assess_assessment-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "p1iWz66omA4ieLqRF1mHw0JjwsHa/7DW0vF+4DHSojA=",
            "source_code_size": 940,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.module.assess_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.data.archive_file.assess_assessment",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assessment_result_complete",
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": null,
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": null,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": null,
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": null,
            "name": "salesforce-assessment_result_complete",
            "name_prefix": "",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"MyTopicPolicy\",\"Statement\":[{\"Sid\":\"My-statement-id\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"inspector.amazonaws.com\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}",
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": null,
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assessment_result_complete",
      "mode": "managed",
      "type": "aws_sns_topic_policy",
      "name": "default",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"MyTopicPolicy\",\"Statement\":[{\"Sid\":\"My-statement-id\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"inspector.amazonaws.com\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.public",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.assessment_complete",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.assessment_result_complete",
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete:49d28602-ff7f-4470-9a80-dc70d8a4d930",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": true,
            "delivery_policy": "",
            "endpoint": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-analyse_findings",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete:49d28602-ff7f-4470-9a80-dc70d8a4d930",
            "owner_id": "246512022090",
            "pending_confirmation": false,
            "protocol": "lambda",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.module.analyse_findings.aws_lambda_function.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route_table_association.public",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_sns_topic.assessment_result",
            "module.scanner.data.archive_file.analyse_findings",
            "module.scanner.module.analyse_findings.aws_iam_role.execution-role",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.decommision_ami_version",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-decommission_ami_version-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-decommission_ami_version-lambda-additional-permission",
            "name": "salesforce-decommission_ami_version-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\",\n        \"ssm:delete*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:delete*\",\n        \"s3:get*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::salesforce-ami-config-bucket/*\",\n        \"arn:aws:s3:::salesforce-ami-config-bucket\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DeleteSnapshot\",\n        \"sc:list*\",\n        \"sc:search*\",\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:ListProvisioningArtifacts\",\n        \"servicecatalog:DeleteProduct\",\n        \"servicecatalog:DeleteProvisioningArtifact\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFATHHDKVPD",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.decommission_ami_version",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.decommision_ami_version",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-decommission_ami_version-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:57Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-decommission_ami_version-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-decommission_ami_version-lambda-additional-permission",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-decommission_ami_version-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFMBYB2776B"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.decommision_ami_version",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-decommission_ami_version-lambda-execution-role-20210907105532617700000010",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-decommission_ami_version-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.decommision_ami_version.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.decommision_ami_version",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-decommission_ami_version-lambda-execution-role-20210907105548110000000015",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-decommission_ami_version-lambda-additional-permission",
            "role": "salesforce-decommission_ami_version-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.module.decommision_ami_version.aws_iam_policy.policy",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.decommision_ami_version.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.scanner.data.template_file.decommission_ami_version",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_route.private_internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.decommision_ami_version",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/decommission_ami_version.zip",
            "function_name": "salesforce-decommission_ami_version",
            "handler": "index.lambda_handler",
            "id": "salesforce-decommission_ami_version",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:56:10.192+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-decommission_ami_version:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-decommission_ami_version-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "XvFYeKQ/HZE7Fb4ETt48nLIi3fChHg3egOpkqWo4QrE=",
            "source_code_size": 1367,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.archive_file.decommission_ami_version",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_subnet.public",
            "module.scanner.module.decommision_ami_version.aws_iam_role.execution-role",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-initiate_assessment-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-initiate_assessment-lambda-additional-permission",
            "name": "salesforce-initiate_assessment-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\",\n        \"ssm:PutParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Action\": \"ssm:SendCommand\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:ssm:us-east-1::document/AmazonInspector-ManageAWSAgent\",\n        \"arn:aws:ec2:us-east-1:246512022090:instance/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:ListAssessmentTemplates\",\n        \"inspector:StartAssessmentRun\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFFJ3FH4QZZ",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.data.template_file.initiate_assessment",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.scanner.data.aws_region.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.data.aws_caller_identity.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-initiate_assessment-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:51Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-initiate_assessment-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-initiate_assessment-lambda-additional-permission",
              "arn:aws:iam::aws:policy/AmazonEC2FullAccess",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-initiate_assessment-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFOHJFUFGJK"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "additional_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-initiate_assessment-lambda-execution-role-2021090710552067410000000c",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2FullAccess",
            "role": "salesforce-initiate_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table_association.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-initiate_assessment-lambda-execution-role-2021090710552068680000000e",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-initiate_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-initiate_assessment-lambda-execution-role-20210907105548128000000017",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-initiate_assessment-lambda-additional-permission",
            "role": "salesforce-initiate_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.aws_region.this",
            "module.scanner.data.template_file.initiate_assessment",
            "module.scanner.module.initiate_assessment.aws_iam_policy.policy",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_subnet.private",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.initiate_assessment",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/initiate_assessment.zip",
            "function_name": "salesforce-initiate_assessment",
            "handler": "index.lambda_handler",
            "id": "salesforce-initiate_assessment",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:55:54.838+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-initiate_assessment:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-initiate_assessment-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "bd7MSBVHFNq78GEtfDRMK3X/AqLAhRMts9kd6DeyT8w=",
            "source_code_size": 643,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.inspector_complete",
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": null,
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": null,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": null,
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": null,
            "name": "salesforce-approver",
            "name_prefix": "",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"ApproverTopicPolicy\",\"Statement\":[{\"Sid\":\"ApproverTopicPolicySID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::246512022090:role/terraform-20210907105437499900000002\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}",
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": null,
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route.private_internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.inspector_complete",
      "mode": "managed",
      "type": "aws_sns_topic_policy",
      "name": "default",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver",
            "owner": "246512022090",
            "policy": "{\"Version\":\"2012-10-17\",\"Id\":\"MyTopicPolicy\",\"Statement\":[{\"Sid\":\"inspector-notifications-policy\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::485811472374:root\"},\"Action\":\"sns:Publish\",\"Resource\":\"*\"}]}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.inspector_complete",
            "module.scanner.module.inspector_complete.aws_sns_topic.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.inspector_complete",
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver:445a5f67-3f79-43d0-bd55-0d87236ee3be",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": true,
            "delivery_policy": "",
            "endpoint": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-assess_assessment",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "id": "arn:aws:sns:us-east-1:246512022090:salesforce-approver:445a5f67-3f79-43d0-bd55-0d87236ee3be",
            "owner_id": "246512022090",
            "pending_confirmation": false,
            "protocol": "lambda",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-east-1:246512022090:salesforce-approver"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.scanner.module.inspector_complete.aws_sns_topic.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.archive_file.assess_assessment",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.assess_assessment.aws_iam_role.execution-role",
            "module.scanner.module.assess_assessment.aws_lambda_function.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.publish_ami_lambda",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-publish_lambda-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-publish_lambda-lambda-additional-permission",
            "name": "salesforce-publish_lambda-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject*\",\n        \"s3:PutObject*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::salesforce-ami-config-bucket/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:SearchProductsAsAdmin\",\n        \"servicecatalog:CreateProvisioningArtifact\",\n        \"servicecatalog:CreateProduct\",\n        \"cloudformation:ValidateTemplate\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
            "policy_id": "ANPATSZKC6JFN565QKFQZ",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.aws_caller_identity.this",
            "module.scanner.data.template_file.publish_ami_policy_json",
            "module.vpc.aws_eip.nat"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.publish_ami_lambda",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-publish_lambda-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:38Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-publish_lambda-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-publish_lambda-lambda-additional-permission",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-publish_lambda-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFBO6V6WCK4"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.s3.aws_s3_bucket.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.publish_ami_lambda",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-publish_lambda-lambda-execution-role-20210907105509628400000008",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-publish_lambda-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.publish_ami_lambda.aws_iam_role.execution-role",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.publish_ami_lambda",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-publish_lambda-lambda-execution-role-20210907105548113800000016",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-publish_lambda-lambda-additional-permission",
            "role": "salesforce-publish_lambda-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.publish_ami_lambda.aws_iam_policy.policy",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.scanner.data.template_file.publish_ami_policy_json",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.module.publish_ami_lambda.aws_iam_role.execution-role",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.publish_ami_lambda",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/publish_ami.zip",
            "function_name": "salesforce-publish_lambda",
            "handler": "index.lambda_handler",
            "id": "salesforce-publish_lambda",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:55:11.900+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-publish_lambda:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-publish_lambda-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "P3MG7JXv4tJhQIETUBnKjdNFKR3B1tmDMLONmofmuyo=",
            "source_code_size": 1204,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.archive_file.publish_ami_lambda_artifact",
            "module.scanner.module.publish_ami_lambda.aws_iam_role.execution-role",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-run_inspector-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-run_inspector-lambda-additional-permission",
            "name": "salesforce-run_inspector-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:PutParameter\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:246512022090:parameter/GoldenAMI/*\"\n      ]\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFLSGZHSSV4",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_eip.nat",
            "module.scanner.data.template_file.run_inspector",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_nat_gateway.nat"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-run_inspector-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:45Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-run_inspector-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-run_inspector-lambda-additional-permission",
              "arn:aws:iam::aws:policy/AmazonInspectorFullAccess",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-run_inspector-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFNSFZCPLZF"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_internet_gateway.igw"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "additional_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-run_inspector-lambda-execution-role-20210907105514613200000009",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonInspectorFullAccess",
            "role": "salesforce-run_inspector-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-run_inspector-lambda-execution-role-2021090710552068230000000d",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-run_inspector-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-run_inspector-lambda-execution-role-20210907105548100900000014",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-run_inspector-lambda-additional-permission",
            "role": "salesforce-run_inspector-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.data.template_file.run_inspector",
            "module.scanner.module.run_inspector.aws_iam_policy.policy",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.run_inspector",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "terraform": "true"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/run_inspector.zip",
            "function_name": "salesforce-run_inspector",
            "handler": "index.lambda_handler",
            "id": "salesforce-run_inspector",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:55:24.086+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-run_inspector:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-run_inspector-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "1qe+jOGowSfywyNvggNgNF0518BJZJezpKdDqxPjuCU=",
            "source_code_size": 1033,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.module.run_inspector.aws_iam_role.execution-role",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.private",
            "module.scanner.data.archive_file.run_inspector",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.internet"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:policy/salesforce-setup_continuous_assessment-lambda-additional-permission",
            "description": "",
            "id": "arn:aws:iam::246512022090:policy/salesforce-setup_continuous_assessment-lambda-additional-permission",
            "name": "salesforce-setup_continuous_assessment-lambda-additional-permission",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"StartContinuousAssessmentLambdaPolicyStmt2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:StartAutomationExecution\",\n      \"Resource\": [\n        \"arn:aws:ssm:us-east-1:246512022090:automation-definition/:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopyImage\",\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:createTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AMI-Type\",\n            \"ProductName\",\n            \"continuous-assessment-instance\",\n            \"ProductOSAndVersion\",\n            \"version\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssociateIamInstanceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::246512022090:role/terraform-20210907105437466900000001\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:us-east-1::image/ami-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AMI-Type\": \"Golden\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:us-east-1:246512022090:instance/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:subnet/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:volume/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:network-interface/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:key-pair/*\",\n        \"arn:aws:ec2:us-east-1:246512022090:security-group/*\"\n      ]\n    }\n  ]\n}",
            "policy_id": "ANPATSZKC6JFOXA7PAD4H",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.data.aws_caller_identity.this",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this",
            "module.scanner.data.aws_region.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.data.template_file.setup_continuous_assessment",
            "module.vpc.aws_eip.nat"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "execution-role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::246512022090:role/salesforce-setup_continuous_assessment-lambda-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2021-09-07T10:54:51Z",
            "description": "",
            "force_detach_policies": false,
            "id": "salesforce-setup_continuous_assessment-lambda-execution-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::246512022090:policy/salesforce-setup_continuous_assessment-lambda-additional-permission",
              "arn:aws:iam::aws:policy/AmazonInspectorFullAccess",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "salesforce-setup_continuous_assessment-lambda-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATSZKC6JFFL6TPSEJF"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "additional_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-setup_continuous_assessment-lambda-execution-role-2021090710552065010000000b",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonInspectorFullAccess",
            "role": "salesforce-setup_continuous_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_subnet.private",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.public"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-setup_continuous_assessment-lambda-execution-role-2021090710552665890000000f",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "salesforce-setup_continuous_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_route_table.private"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "salesforce-setup_continuous_assessment-lambda-execution-role-20210907105554277400000019",
            "policy_arn": "arn:aws:iam::246512022090:policy/salesforce-setup_continuous_assessment-lambda-additional-permission",
            "role": "salesforce-setup_continuous_assessment-lambda-execution-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_route_table_association.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.scanner.data.aws_caller_identity.this",
            "module.scanner.data.aws_region.this",
            "module.scanner.module.setup_continuous_assessment.aws_iam_policy.policy",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.scanner.aws_iam_role.managed_instance",
            "module.vpc.aws_route.private_internet",
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_route.internet",
            "module.scanner.data.template_file.setup_continuous_assessment",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_vpc.this",
            "module.s3.aws_s3_bucket.this"
          ]
        }
      ]
    },
    {
      "module": "module.scanner.module.setup_continuous_assessment",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-setup_continuous_assessment",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "continuous_assessment_complete_topic": "arn:aws:sns:us-east-1:246512022090:salesforce-assessment_result_complete",
                  "continuous_assessment_target": "arn:aws:inspector:us-east-1:246512022090:target/0-7U8w7ZDt",
                  "managed_instance_iam_role": "arn:aws:iam::246512022090:role/terraform-20210907105437466900000001",
                  "run_continuous_inspection": "run_continuous_inspection",
                  "security_group_id": "sg-0eb183a7c40d99209",
                  "subnet_id": "arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f"
                }
              }
            ],
            "file_system_config": [],
            "filename": "./target/lambda/setup_continuous_assessment.zip",
            "function_name": "salesforce-setup_continuous_assessment",
            "handler": "index.lambda_handler",
            "id": "salesforce-setup_continuous_assessment",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:246512022090:function:salesforce-setup_continuous_assessment/invocations",
            "kms_key_arn": "",
            "last_modified": "2021-09-07T10:57:01.069+0000",
            "layers": [],
            "memory_size": 512,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:246512022090:function:salesforce-setup_continuous_assessment:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::246512022090:role/salesforce-setup_continuous_assessment-lambda-execution-role",
            "runtime": "python3.6",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "source_code_hash": "ER0G3AB8VFcqvY40VenmyBiB5oWwWcVfGn/iWjhp++w=",
            "source_code_size": 1227,
            "tags": {},
            "tags_all": {},
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.scanner.aws_inspector_resource_group.this",
            "module.scanner.data.template_file.run_continuous_inspection",
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_route.private_internet",
            "module.scanner.data.archive_file.initiate_assessment",
            "module.vpc.aws_route.internet",
            "module.vpc.aws_security_group_rule.ingress",
            "module.vpc.aws_vpc.this",
            "module.scanner.module.initiate_assessment.aws_lambda_function.this",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table_association.private",
            "module.s3.aws_s3_bucket.this",
            "module.scanner.aws_inspector_assessment_target.this",
            "module.scanner.module.setup_continuous_assessment.aws_iam_role.execution-role",
            "module.scanner.aws_iam_role.managed_instance",
            "module.scanner.aws_ssm_document.run_continuous_inspection",
            "module.scanner.data.archive_file.setup_continuous_assessment",
            "module.vpc.aws_security_group.this",
            "module.scanner.aws_iam_role.automation_service",
            "module.scanner.module.assessment_result_complete.aws_sns_topic.this",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_route_table_association.public",
            "module.vpc.aws_subnet.private",
            "module.scanner.module.initiate_assessment.aws_iam_role.execution-role",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_eip",
      "name": "nat",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address": null,
            "allocation_id": null,
            "associate_with_private_ip": null,
            "association_id": "eipassoc-00c4119dde874f104",
            "carrier_ip": "",
            "customer_owned_ip": "",
            "customer_owned_ipv4_pool": "",
            "domain": "vpc",
            "id": "eipalloc-09e1071ffd2f97951",
            "instance": "",
            "network_border_group": "us-east-1",
            "network_interface": "eni-086a2366efd3112d6",
            "private_dns": "ip-10-0-1-38.ec2.internal",
            "private_ip": "10.0.1.38",
            "public_dns": "ec2-34-199-57-208.compute-1.amazonaws.com",
            "public_ip": "34.199.57.208",
            "public_ipv4_pool": "amazon",
            "tags": {
              "Name": "salesforce-nat-eip",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "tags_all": {
              "Name": "salesforce-nat-eip",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "timeouts": null,
            "vpc": true
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjoxODAwMDAwMDAwMDAsInJlYWQiOjkwMDAwMDAwMDAwMCwidXBkYXRlIjozMDAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_internet_gateway",
      "name": "igw",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:internet-gateway/igw-00e409a40e117cbcb",
            "id": "igw-00e409a40e117cbcb",
            "owner_id": "246512022090",
            "tags": {},
            "tags_all": {},
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_nat_gateway",
      "name": "nat",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allocation_id": "eipalloc-09e1071ffd2f97951",
            "connectivity_type": "public",
            "id": "nat-0bb771e5d1eac890e",
            "network_interface_id": "eni-086a2366efd3112d6",
            "private_ip": "10.0.1.38",
            "public_ip": "34.199.57.208",
            "subnet_id": "subnet-0913b3ceb71b46f82",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_eip.nat"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route",
      "name": "internet",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "carrier_gateway_id": "",
            "destination_cidr_block": "0.0.0.0/0",
            "destination_ipv6_cidr_block": "",
            "destination_prefix_list_id": "",
            "egress_only_gateway_id": "",
            "gateway_id": "igw-00e409a40e117cbcb",
            "id": "r-rtb-041e689c0c18ad8b91080289494",
            "instance_id": "",
            "instance_owner_id": "",
            "local_gateway_id": "",
            "nat_gateway_id": "",
            "network_interface_id": "",
            "origin": "CreateRoute",
            "route_table_id": "rtb-041e689c0c18ad8b9",
            "state": "active",
            "timeouts": null,
            "transit_gateway_id": "",
            "vpc_endpoint_id": "",
            "vpc_peering_connection_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route",
      "name": "private_internet",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "carrier_gateway_id": "",
            "destination_cidr_block": "0.0.0.0/0",
            "destination_ipv6_cidr_block": "",
            "destination_prefix_list_id": "",
            "egress_only_gateway_id": "",
            "gateway_id": "",
            "id": "r-rtb-01d03aa91af9353341080289494",
            "instance_id": "",
            "instance_owner_id": "",
            "local_gateway_id": "",
            "nat_gateway_id": "nat-0bb771e5d1eac890e",
            "network_interface_id": "",
            "origin": "CreateRoute",
            "route_table_id": "rtb-01d03aa91af935334",
            "state": "active",
            "timeouts": null,
            "transit_gateway_id": "",
            "vpc_endpoint_id": "",
            "vpc_peering_connection_id": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.vpc.aws_eip.nat",
            "module.vpc.aws_internet_gateway.igw",
            "module.vpc.aws_nat_gateway.nat",
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route_table",
      "name": "private",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:route-table/rtb-01d03aa91af935334",
            "id": "rtb-01d03aa91af935334",
            "owner_id": "246512022090",
            "propagating_vgws": [],
            "route": [
              {
                "carrier_gateway_id": "",
                "cidr_block": "0.0.0.0/0",
                "destination_prefix_list_id": "",
                "egress_only_gateway_id": "",
                "gateway_id": "",
                "instance_id": "",
                "ipv6_cidr_block": "",
                "local_gateway_id": "",
                "nat_gateway_id": "nat-0bb771e5d1eac890e",
                "network_interface_id": "",
                "transit_gateway_id": "",
                "vpc_endpoint_id": "",
                "vpc_peering_connection_id": ""
              }
            ],
            "tags": {
              "Name": "salesforce-private-routetable",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "tags_all": {
              "Name": "salesforce-private-routetable",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route_table",
      "name": "public",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:route-table/rtb-041e689c0c18ad8b9",
            "id": "rtb-041e689c0c18ad8b9",
            "owner_id": "246512022090",
            "propagating_vgws": [],
            "route": [
              {
                "carrier_gateway_id": "",
                "cidr_block": "0.0.0.0/0",
                "destination_prefix_list_id": "",
                "egress_only_gateway_id": "",
                "gateway_id": "igw-00e409a40e117cbcb",
                "instance_id": "",
                "ipv6_cidr_block": "",
                "local_gateway_id": "",
                "nat_gateway_id": "",
                "network_interface_id": "",
                "transit_gateway_id": "",
                "vpc_endpoint_id": "",
                "vpc_peering_connection_id": ""
              }
            ],
            "tags": {},
            "tags_all": {},
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route_table_association",
      "name": "private",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "gateway_id": "",
            "id": "rtbassoc-0c1484a4c54ddd397",
            "route_table_id": "rtb-01d03aa91af935334",
            "subnet_id": "subnet-0d7e9e2d65e1cda6f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.private",
            "module.vpc.aws_subnet.private",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_route_table_association",
      "name": "public",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "gateway_id": "",
            "id": "rtbassoc-0fc7068aaf19e2f19",
            "route_table_id": "rtb-041e689c0c18ad8b9",
            "subnet_id": "subnet-0913b3ceb71b46f82"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.vpc.aws_route_table.public",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_security_group",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:security-group/sg-0eb183a7c40d99209",
            "description": "Managed by Terraform",
            "egress": [],
            "id": "sg-0eb183a7c40d99209",
            "ingress": [
              {
                "cidr_blocks": [
                  "0.0.0.0/0"
                ],
                "description": "",
                "from_port": 1,
                "ipv6_cidr_blocks": [],
                "prefix_list_ids": [],
                "protocol": "tcp",
                "security_groups": [],
                "self": false,
                "to_port": 65525
              }
            ],
            "name": "salesforce-default-vpc-sg",
            "name_prefix": "",
            "owner_id": "246512022090",
            "revoke_rules_on_delete": false,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6OTAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_security_group_rule",
      "name": "ingress",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "",
            "from_port": 1,
            "id": "sgrule-1634118240",
            "ipv6_cidr_blocks": [],
            "prefix_list_ids": [],
            "protocol": "tcp",
            "security_group_id": "sg-0eb183a7c40d99209",
            "self": false,
            "source_security_group_id": null,
            "to_port": 65525,
            "type": "ingress"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjIifQ==",
          "dependencies": [
            "module.vpc.aws_security_group.this",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_subnet",
      "name": "private",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0d7e9e2d65e1cda6f",
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-east-1d",
            "availability_zone_id": "use1-az4",
            "cidr_block": "10.0.2.0/24",
            "customer_owned_ipv4_pool": "",
            "id": "subnet-0d7e9e2d65e1cda6f",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_association_id": "",
            "map_customer_owned_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "outpost_arn": "",
            "owner_id": "246512022090",
            "tags": {
              "Name": "salesforce-private-subnet",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "tags_all": {
              "Name": "salesforce-private-subnet",
              "Tier": "private",
              "VPC": "default-vpc"
            },
            "timeouts": null,
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_subnet",
      "name": "public",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:subnet/subnet-0913b3ceb71b46f82",
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-east-1d",
            "availability_zone_id": "use1-az4",
            "cidr_block": "10.0.1.0/24",
            "customer_owned_ipv4_pool": "",
            "id": "subnet-0913b3ceb71b46f82",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_association_id": "",
            "map_customer_owned_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "outpost_arn": "",
            "owner_id": "246512022090",
            "tags": {
              "Name": "salesforce-public-subnet",
              "Tier": "public",
              "VPC": "default-vpc"
            },
            "tags_all": {
              "Name": "salesforce-public-subnet",
              "Tier": "public",
              "VPC": "default-vpc"
            },
            "timeouts": null,
            "vpc_id": "vpc-035be140d6d15d12b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "module.vpc.aws_vpc.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_vpc",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-east-1:246512022090:vpc/vpc-035be140d6d15d12b",
            "assign_generated_ipv6_cidr_block": false,
            "cidr_block": "10.0.0.0/16",
            "default_network_acl_id": "acl-0ead8a6d11b2dd463",
            "default_route_table_id": "rtb-0409da5c558b50ba3",
            "default_security_group_id": "sg-066fbb4ac7ecb60c1",
            "dhcp_options_id": "dopt-d29b7caf",
            "enable_classiclink": false,
            "enable_classiclink_dns_support": false,
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "id": "vpc-035be140d6d15d12b",
            "instance_tenancy": "default",
            "ipv6_association_id": "",
            "ipv6_cidr_block": "",
            "main_route_table_id": "rtb-0409da5c558b50ba3",
            "owner_id": "246512022090",
            "tags": {
              "Name": "salesforce-default-vpc"
            },
            "tags_all": {
              "Name": "salesforce-default-vpc"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ]
}
